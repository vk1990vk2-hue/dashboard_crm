<html lang="ru"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced CRM Tasks Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            padding: 20px;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }
        .dashboard-header {
            background: linear-gradient(135deg, #6B73FF 0%, #000DFF 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 600;
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border: none;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        }
        .card-header {
            background-color: #2c3e50;
            color: white;
            border-radius: 10px 10px 0 0 !important;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
        }
        .card-title {
            margin-bottom: 0;
            font-size: 1.15rem;
            font-weight: 500;
        }
        .card-body {
            padding: 15px;
        }
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block; /* Ensures padding and margins apply correctly */
        }
        .status-completed { background-color: #28a745; color: white; }
        .status-inprogress { background-color: #ffc107; color: #212529; }
        .status-queued { background-color: #6c757d; color: white; }
        .status-paused { background-color: #dc3545; color: white; }
        
        .table-responsive {
            max-height: 500px;
            overflow-y: auto;
            border-radius: 8px; /* Add some border-radius to table wrapper */
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); /* Subtle shadow */
        }
        #tasksTable {
            border-collapse: separate; /* Necessary for border-radius on cells */
            border-spacing: 0;
            width: 100%;
        }
        #tasksTable th, #tasksTable td {
            vertical-align: middle; /* Vertically center content */
            padding: 12px 15px; /* Consistent padding */
        }
        #tasksTable thead th {
            background-color: #e9ecef;
            color: #495057;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.875rem;
            border-bottom: 1px solid #dee2e6;
        }
        #tasksTable tbody tr:nth-child(odd) {
            background-color: #f8f9fa; /* Zebra striping */
        }
        #tasksTable tbody tr:hover {
            background-color: #e2e6ea; /* Hover effect */
            cursor: pointer;
        }
        
        .priority-high { color: #dc3545; font-weight: bold; }
        .priority-medium { color: #ffc107; font-weight: bold; }
        .priority-low { color: #28a745; font-weight: bold; }
        
        .filter-section {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        .filter-section label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #555;
        }
        .form-select, .form-control, .form-label {
             font-size: 0.9rem; /* Slightly smaller font for form elements */
        }
        .kpi-card {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            height: 100%; /* Ensure cards take full height */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Center content vertically */
        }
        .kpi-value {
            font-size: 2.2rem; /* Increased font size for KPIs */
            font-weight: bold;
            margin: 10px 0;
            color: #333;
        }
        .kpi-label {
            font-size: 1.0rem;
            color: #6c757d;
            font-weight: 500;
        }
        
        .modal-comments {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 10px;
            background-color: #fdfdfd;
        }
        .comment-item {
            border-left: 3px solid #007bff;
            padding-left: 10px;
            margin-bottom: 15px;
            background-color: #fff;
            padding-top: 5px;
            padding-bottom: 5px;
        }
        .comment-date {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 5px;
            display: block;
        }
        .task-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
        }
        .edit-btn {
            cursor: pointer;
            color: #007bff;
            margin-left: 8px;
            font-size: 1.1rem;
            vertical-align: middle;
        }
        .edit-btn:hover {
            color: #0056b3;
        }
        .chart-container {
            position: relative;
            height: 300px; /* Fixed height for charts */
            margin-bottom: 20px;
        }
        .chart-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 100;
        }
        .chart-card .card-title {
            font-size: 1rem; /* Smaller title for chart cards */
        }
        .sort-icon {
            font-size: 0.8em;
            margin-left: 5px;
        }
        .sorted-asc::after, .sorted-desc::after {
            content: none !important; /* Icons are added directly */
        }
        
        /* Row styling for due dates */
        .overdue { background-color: #ffdddd !important; }
        .due-soon { background-color: #fff3cd !important; }
        .on-track { background-color: #d4edda !important; }
        
        .timeline-bar {
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
            position: relative; /* For timeline-text */
            width: 100%;
        }
        .timeline-progress {
            height: 100%;
            background-color: #28a745;
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
        }
        .timeline-text {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            text-align: center;
            color: #fff;
            line-height: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .col-editable {
            position: relative; /* For hover effect on editable fields */
        }
        .col-editable:hover .edit-btn {
            display: inline-block; /* Show edit icon on hover */
        }
        .edit-btn-placeholder { /* To maintain spacing when edit button is hidden */
            display: inline-block;
            width: 20px;
            height: 1em;
            vertical-align: middle;
        }
        
        /* KPI Filter Toggle */
        .kpi-filter-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #6c757d;
        }
        .kpi-filter-toggle .form-check-input {
            margin-left: 10px;
        }
        
        /* Search input */
        #taskSearch {
            max-width: 300px; /* Limit search bar width */
        }
        
        /* Drag and Drop styling for charts */
        .drag-over {
            border-color: #007bff !important;
            border-style: dashed !important;
            background-color: #e7f3ff !important;
        }
    </style>
</head>
<body class="" style="">
    <div class="container-fluid">
        <div class="dashboard-header">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="mb-0"><i class="bi bi-clipboard-data me-2"></i> Advanced CRM Tasks Dashboard</h1>
                </div>
                <div class="col-md-4 text-md-end text-center">
                    <button class="btn btn-outline-light me-2" id="uploadExcelBtn"><i class="bi bi-upload"></i> Загрузить Excel</button>
                    <input type="file" id="excelFileInput" accept=".xlsx,.xls" multiple="" style="display: none;">
                    <button class="btn btn-outline-light me-2" id="saveDashboardBtn"><i class="bi bi-cloud-arrow-up"></i> Сохранить данные</button>
                    <button class="btn btn-outline-light" id="saveHtmlBtn"><i class="bi bi-file-earmark-arrow-down"></i> Сохранить в HTML</button>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-12">
                <div class="filter-section">
                    <div class="row g-3 align-items-end">
                        <div class="col-md-3">
                            <label for="categoryFilter" class="form-label">Категория:</label>
                            <select id="categoryFilter" class="form-select" multiple="" size="3"><option value="DWH">DWH</option><option value="Админ">Админ</option><option value="Активность">Активность</option><option value="Аналитика">Аналитика</option><option value="База">База</option><option value="Данные">Данные</option><option value="Дистанционные визиты">Дистанционные визиты</option><option value="Запросы">Запросы</option><option value="Интеграция ">Интеграция </option><option value="Карта">Карта</option><option value="Контактная информация">Контактная информация</option><option value="Маркет циклы">Маркет циклы</option><option value="Опросники">Опросники</option><option value="Орг структура">Орг структура</option><option value="Ошибка ">Ошибка </option><option value="Ошибки">Ошибки</option><option value="Поддержка">Поддержка</option><option value="Поиск">Поиск</option><option value="Пользователи">Пользователи</option><option value="Презентации">Презентации</option><option value="Приложение">Приложение</option><option value="Сервер">Сервер</option><option value="Синхронизация">Синхронизация</option><option value="Согласия">Согласия</option><option value="Среда">Среда</option><option value="Таргетирование">Таргетирование</option></select>
                        </div>
                        <div class="col-md-2">
                            <label for="statusFilter" class="form-label">Статус:</label>
                            <select id="statusFilter" class="form-select" multiple="" size="3">
                                <option value="Завершена">Завершена</option>
                                <option value="В работе">В работе</option>
                                <option value="В очереди">В очереди</option>
                                <option value="Пауза">Пауза</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="responsibleFilter" class="form-label">Ответственный:</label>
                            <select id="responsibleFilter" class="form-select" multiple="" size="3">
                                <option value="Промомед">Промомед</option>
                                <option value="Мастердата">Мастердата</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="priorityFilter" class="form-label">Приоритет:</label>
                            <select id="priorityFilter" class="form-select" multiple="" size="3">
                                <option value="1">Высокий</option>
                                <option value="2">Средний</option>
                                <option value="3">Низкий</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="dueStatusFilter" class="form-label">Статус выполнения:</label>
                            <select id="dueStatusFilter" class="form-select" multiple="" size="3">
                                <option value="overdue">Просроченные</option>
                                <option value="due-soon">Скоро срок</option>
                                <option value="on-track">По плану</option>
                                <option value="no-due-date">Без срока</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12 d-flex flex-wrap gap-2">
                            <button id="applyFilters" class="btn btn-primary px-3"><i class="bi bi-filter-square me-1"></i> Применить</button>
                            <button id="resetFilters" class="btn btn-outline-secondary px-3"><i class="bi bi-arrow-clockwise me-1"></i> Сбросить</button>
                            <input type="text" id="taskSearch" class="form-control w-auto flex-grow-1" placeholder="Поиск по описанию...">
                            <button id="addTask" class="btn btn-success px-3 ms-auto"><i class="bi bi-plus-circle me-1"></i> Добавить задачу</button>
                            <button id="exportExcel" class="btn btn-warning px-3"><i class="bi bi-file-earmark-excel me-1"></i> Экспорт Excel</button>
                            <button id="addChartBtn" class="btn btn-info px-3"><i class="bi bi-plus-circle me-1"></i> Добавить график</button>
                            <button id="deleteAllTasksBtn" class="btn btn-danger px-3 ms-auto"><i class="bi bi-trash me-1"></i> Удалить все задачи</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-3">
                <div class="kpi-card">
                    <div class="kpi-label">Всего задач</div>
                    <div class="kpi-value" id="totalTasks">100</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="kpi-card">
                    <div class="kpi-label">Завершено</div>
                    <div class="kpi-value" id="completedTasks">63</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="kpi-card">
                    <div class="kpi-label">В работе</div>
                    <div class="kpi-value" id="inProgressTasks">13</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="kpi-card">
                    <div class="kpi-label">Просрочено</div>
                    <div class="kpi-value" id="overdueTasks">0</div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center mt-2">
            <div class="col-md-4">
                 <div class="kpi-filter-toggle">
                    Учитывать фильтры в KPI:
                    <div class="form-check form-switch ms-2">
                        <input class="form-check-input" type="checkbox" id="filterKpiToggle" role="switch" checked="">
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4" id="chartsRow"><div class="col-md-6" id="col-statusChart" draggable="true" data-chart-id="statusChart">
                    <div class="card chart-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Распределение задач по статусам</h5>
                            <div class="d-flex align-items-center">
                                <button class="btn btn-sm btn-outline-secondary me-2 export-chart-btn" data-bs-toggle="tooltip" data-chart-id="statusChart" aria-label="Экспорт графика" data-bs-original-title="Экспорт графика">
                                    <i class="bi bi-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger delete-chart-btn" data-bs-toggle="tooltip" data-chart-id="statusChart" aria-label="Удалить график" data-bs-original-title="Удалить график">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="statusChart" width="837" height="450" style="display: block; box-sizing: border-box; height: 300px; width: 558px;"></canvas> <!-- The canvas element where Chart.js will render the chart -->
                            </div>
                        </div>
                    </div>
                </div><div class="col-md-6" id="col-categoryChart" draggable="true" data-chart-id="categoryChart">
                    <div class="card chart-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Распределение задач по категориям</h5>
                            <div class="d-flex align-items-center">
                                <button class="btn btn-sm btn-outline-secondary me-2 export-chart-btn" data-bs-toggle="tooltip" data-chart-id="categoryChart" aria-label="Экспорт графика" data-bs-original-title="Экспорт графика">
                                    <i class="bi bi-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger delete-chart-btn" data-bs-toggle="tooltip" data-chart-id="categoryChart" aria-label="Удалить график" data-bs-original-title="Удалить график">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="categoryChart" width="837" height="450" style="display: block; box-sizing: border-box; height: 300px; width: 558px;"></canvas> <!-- The canvas element where Chart.js will render the chart -->
                            </div>
                        </div>
                    </div>
                </div></div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Список задач</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="tasksTable">
                                <thead id="tasksTableHead">
                                    <tr>
                                        <th data-column="Категория" style="cursor: pointer;">Категория</th>
                                        <th data-column="Описание задачи" style="cursor: pointer;">Описание задачи</th>
                                        <th data-column="Ответственный" style="cursor: pointer;">Ответственный</th>
                                        <th data-column="Приоритет" style="cursor: pointer;">Приоритет</th>
                                        <th data-column="Статус" class="sorted-desc" style="cursor: pointer;">Статус<i class="bi bi-arrow-down sort-icon"></i></th>
                                        <th data-column="dueDate" style="cursor: pointer;">Срок выполнения</th>
                                        <th>Дней на выполнение</th>
                                        <th>Прогресс</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="tasksTableBody"><tr data-task-id="quz629wizzrmdrmy0mz"><td>База</td><td>Привязка организаций к 3 уровню</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="2aq60ryhvqdmdrmy0n2"><td>База</td><td>В системе все организации и контакты должны быть со статусом (49146 организаций) 
</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="vd596xihrqmdrmy0n2"><td>База</td><td>Отображение организаций и контактов только со следующими статусами:
-Активный
-Новый
-Требует дополнительной валидации
-Пустые</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="1plb6lq0j9mmdrmy0n2"><td>База</td><td>1) Ожидаем актуальный файл от Антона
2) Заведение всех ставок
3) Исправление ошибочных данных</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="vsh55gptophmdrmy0n2"><td>База</td><td>0359-12-31</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="tp2x5jk14asmdrmy0n2"><td>База</td><td>1) Исправление ошибки в местах работы
2) Исправление ошибки со специальностями
3) Исправление ошибки отображения в превью
4) Исправление ошибки 
 CR отображении
5) Запуск CR
</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="5ke6xtssyqdmdrmy0n2"><td>База</td><td>1) Функционал не работает, ожидаем решение</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="z8dnfqbqr6smdrmy0n2"><td>База</td><td>Проверка аптек на отсутствие адреса и исправление пустых занчений .</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="ngkrkkj8h9amdrmy0n2"><td>Ошибки</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="wxnlzo5dcapmdrmy0n2"><td>Ошибки</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="9v2wftymvkgmdrmy0n2"><td>Ошибки</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="2nznglc84khmdrmy0n2"><td>Ошибки</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="tu46rm6pi1mdrmy0n2"><td>Ошибки</td><td>Выработан процесс по настройке. Ожидаем актуальный файл по тер структуре</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="j5ufmlw5m3mdrmy0n2"><td>Ошибки</td><td>Ошибка должна уйти в сборке от 07.03. Запросы есть, проверяем способ обновления</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="x12s90z8ztmdrmy0n2"><td>Активность</td><td></td><td></td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="mlrntybi3zmdrmy0n2"><td>Сервер</td><td></td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="ljpp2gr1wucmdrmy0n2"><td>Сервер</td><td></td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="y5algbgksrnmdrmy0n2"><td>Орг структура</td><td>1) Отправлена орг структура 
2) Заведены ставки в тер структуру
3) ожидаем заведения
Прислать форму заведения пользователей</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="y5b2eauts5mdrmy0n2"><td>База</td><td>Данные для фильтра предоставлены, ожидаем реализации на этой неделе</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="2m56wvab4snmdrmy0n2"><td>Активность</td><td>Не возможно закрыть фарм кружок без заполения</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="5auwwyhoalqmdrmy0n2"><td>Активность</td><td>Переместить визит к Кол в Визитные активности для изменения причин отмены</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="kb9ygi7i2prmdrmy0n2"><td>Таргетирование</td><td>Проставить признак таргетирования. Сделать фильтр по целевым аптекам</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="h5c7531ufxvmdrmy0n2"><td>Презентации</td><td>До перелогирования неактивные презентации не исчезают в приложении</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="orrwsx48xasmdrmy0n2"><td>Пользователи</td><td>Требует обсуждения</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="07e35sh5g54umdrmy0n2"><td>Презентации</td><td>Новые презентации ENDO_ кардиологи и эндокринологи отображаются белым экраном</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="b3lt44ymxdqmdrmy0n2"><td>Активность</td><td>Кэширование выпадающих списков</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="2haizte1ngqmdrmy0n2"><td>Ошибки</td><td>Подтипы в визитах к врачу и мероприятиях отображаются с ошибками</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="xt4e8lfzi4emdrmy0n2"><td>Активность</td><td>добавить веса по типам активности</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="kmfex2f212mdrmy0n2"><td>Ошибка </td><td>Не отображаются презентации для Кардиологов и аптек</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="vi9gaalesamdrmy0n2"><td>Ошибка </td><td>Нет активных мест работы</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="m8k8kqmdw4hmdrmy0n3"><td>Ошибка </td><td>Приложение сбрасывается до первичной авторизации и удаляет все данные</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="m7j8of8jk4rmdrmy0n3"><td>Синхронизация</td><td>Запуск фоновой синхронизации при завершении активности</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="83lw0dkdm2imdrmy0n3"><td>Админ</td><td>Добавить понятные причины ошибки синхронизации</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="ggr1fh26fammdrmy0n3"><td>Синхронизация</td><td>Удалить визуальный элемент мгновенной синхронизации в интерфейсе</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="e10etr5yq9mdrmy0n3"><td>Активность</td><td>Сейчас календарь отображается с 8:00, нужно отобразить все 24 часа</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="07m6cmlmwe98mdrmy0n3"><td>Активность</td><td>Опросники не отображаются на новых контактах</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="k33zryi9sufmdrmy0n3"><td>Ошибка </td><td>21.04 произошел массовый сбой, синхронизация перестала проходить у всех</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="agr59l01xhfmdrmy0n3"><td>Активность</td><td>Убедиться, что удаление визитов корректно отрабатывается в веб-интерфейсе</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="1mwn9mtzi7qmdrmy0n3"><td>База</td><td>Выполнить выгрузку организаций, у которых отсутствуют адресные данные.
Дальнейшие действия: направить список в ID-360 для дополнения информации и последующей интеграции обратно в CRM</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="z8iwsafatmamdrmy0n3"><td>База</td><td>Выполнить выгрузку данных по новым врачам и провести их сверку с утверждённым справочником активных специальностей.
Действие: выявить и привести в соответствие специальности, отсутствующие или указанные некорректно.</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="j2f31txei7kmdrmy0n3"><td>Среда</td><td>Развернуть пре прод среду для тестирования релизов</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="8a8osy25qetmdrmy0n3"><td>Активность</td><td>Статус соответствия местонахождения</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="6cwfwjnabvbmdrmy0n3"><td>Аналитика</td><td>Подвязана под маркет циклы</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="ded0neq3latmdrmy0n3"><td>Аналитика</td><td>Проанализировать аналитику по визитам, понять почему не проставляется ВЭ, тип, фактическое время и не отображается детализация у таких визитов. Исправить пустые и неверные значения</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="6xg83fnvetnmdrmy0n3"><td>Данные</td><td>Выравнивание должностей по уровням</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="c4ai7oizpfsmdrmy0n3"><td>Сервер</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="2d7ig1cn1qmdrmy0n3"><td>Активность</td><td>У врачей со статусом "Новый доктор" не работает автозаполнение карточки активности по типу записи и типу</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="8g58z3zo0ftmdrmy0n3"><td>Согласия</td><td>Функционал отзыва согласий и отдельных коммуникаций</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="rahst1vdremdrmy0n3"><td>Контактная информация</td><td>Отображение тригера о стадии подписания согласия в карточке врача
</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="dn8cnk8wzkmdrmy0n3"><td>Аналитика</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="65usrg0hcnrmdrmy0n3"><td>Активность</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="vikm4v8vv3lmdrmy0n3"><td>Активность</td><td>Поменять местами отображение информации на карточке физита в календаре, Снаяала ФИО затем ЛПУ</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="bsiy9egpzydmdrmy0n3"><td>Активность</td><td>Визит в аптеку добавление </td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="cgk8ync647wmdrmy0n3"><td>Активность</td><td></td><td></td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="f94kxskl4pomdrmy0n3"><td>Активность</td><td></td><td></td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="xhxci9zterbmdrmy0n3"><td>Орг структура</td><td></td><td></td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="4o1t66e6cgimdrmy0n3"><td>Поиск</td><td>Для поиска сейчас очень важен порядок формирования закпроса, нужно уйти от зависимости порядка</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="3lj5iaq8857mdrmy0n3"><td>Поиск</td><td>Нужна возможность одновременно искать по информации из ФИО и организации. Например Фамилия и название организации</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="z8t6eonvcgmdrmy0n3"><td>База</td><td>Нужна выгрузка с обозначением таргета для сверки</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="22msog45j2nmdrmy0n3"><td>База</td><td>1) Обозначить ошибочные данные
2) Убрать ошибки</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="ppgsfkrpymmdrmy0n3"><td>База</td><td>Проговорить с айди забор новых данных нозология стаж и тд</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="217kkh15i1emdrmy0n3"><td>Активность</td><td>Изменить отображение информации: удалить поле категории "Аптеки"</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="03x4auxjkxknmdrmy0n3"><td>Ошибка </td><td>Удалить дубли</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">завершена</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="tmisd9c7naemdrmy0n3"><td>Активность</td><td>Сначала отображаем ФИО затем ЛПУ</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-completed">Завершена</span></td><td>-</td><td>Выполнено за 0 д.</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="dgmcpdzcb9bmdrmy0n3"><td>Активность</td><td>План выписки к 1.06. Требует доп обсуждения</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">Не указан</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="j9qh9kedxhmdrmy0n3"><td>Аналитика</td><td>Продумать сводный анализ по синхронизации</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-paused">Пауза</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="nax6exr0h3smdrmy0n3"><td>Активность</td><td>Чек геолокации при завершении активности</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="u8rmzvr4fddmdrmy0n3"><td>Опросники</td><td>Необходимо произвести корректировки по функционалу:
1) Невозможность закрыть визит если опросник не заполнен до конца
2) Привязка опросника к контакту
3) Проверка заполнения данных
4) Период открытия и закрытия редактирования
5) Администрирования открытия и закрытия на отдельных сотрудников</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="e8ohd7406wamdrmy0n3"><td>Активность</td><td>Необходимо закрыть возможномть редактирования прошлой недели, т.е. можно редактировать только активности текущей недели. Управление разрешением редактирования администратором.</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="u0la9cyjmromdrmy0n3"><td>Аналитика</td><td>Отображение суммы визит эквивалентов за день на главном экране</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="eegx7azyz2mdrmy0n3"><td>Контактная информация</td><td>Возможность добавить дополнительную почту и номер. Требует встречи для обсуждения работы сбора ПД</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="pqs1gnxdx2mdrmy0n3"><td>База</td><td>Прописать специальности, по которым не отправляем запросы</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="70il6cd6c3pmdrmy0n3"><td>Активность</td><td>Предоставить данные для загрузки с августа 2024 года</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="yeflo6trahmdrmy0n3"><td>Орг структура</td><td>Предоставить данные</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="spmwry3mvwmdrmy0n3"><td>Запросы</td><td>визуализация в бэке тип запроса с детализацией по персоне</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="fzwmlfp5p4pmdrmy0n3"><td>Интеграция </td><td>передача брендов и SKU</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="az2ih4022zlmdrmy0n3"><td>Запросы</td><td>Отображение в бэке подробную информацию по запросам на изменение</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="22d8563ardumdrmy0n3"><td>Карта</td><td>Подключение карты для маршрутов и организаций рядом</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="lcqa1jbqx2mmdrmy0n3"><td>DWH</td><td>Забор данных по привязки организаций к территориальной модели</td><td></td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="fhhndy6jz0cmdrmy0n3"><td>Контактная информация</td><td>Предоставить данные после выравнивания базы</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="1pbdesfg9fhmdrmy0n3"><td>Активность</td><td>Ожидаем оценку</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="d99vairjz9jmdrmy0n3"><td>Активность</td><td></td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="zh4bxt1er9mdrmy0n3"><td>Интеграция </td><td>Настройка BI</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="kejbj6spivlmdrmy0n3"><td>Контактная информация</td><td>Требует обсуждения</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="5pc6sxqyezqmdrmy0n4"><td>Синхронизация</td><td>Определение приоритетности объектов в случае проведение повторной синхронизации после возникновения ошибок</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="tawv2u8hghmdrmy0n4"><td></td><td>Системные оповещения (сервер, бизнес процессы)</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="rp45cwrs7cmdrmy0n4"><td>Активность</td><td>Необходимо понять причину возниконовение дублей</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-queued">В очереди</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="n2k7y7g36vmdrmy0n2"><td>База</td><td>Этап 1: Внести данные по существующей организации и зафиксировать визиты по месту работы.
Этап 2: Создать новую организацию согласно установленным правилам с передачей собственного ID вместо ID 360, дождаться апдейта от провайдера и протестировать процесс интеграции.</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="5jl1u0s0utpmdrmy0n2"><td>База</td><td>Реализовать функционал полного таргетирования на основе выводов и решений, принятых в ходе проведённой встречи.</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="ttllgcm6x5rmdrmy0n2"><td>Сервер</td><td>Создание реплики БД.</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="f2jb8p0t3ummdrmy0n2"><td>Интеграция </td><td>Завершена интеграция по первой части: Данные из гриндаты
На очереди создание территорий и получение обновления тер привязки организаций
</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="mhieafvtwdomdrmy0n2"><td>Интеграция </td><td>Подключение CDP платформы</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="li8zq4vqtmjmdrmy0n2"><td>Поддержка</td><td>Подключение Мастердату на 2-ю линию</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="nltikvx5h7gmdrmy0n3"><td>Активность</td><td>Форма оценки предоставлена, ожидаем описание.</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="vtoq97v8rhmdrmy0n3"><td>Маркет циклы</td><td>Создание функционала маркетингового цикла</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="b7f9ct90hfomdrmy0n3"><td>Приложение</td><td>Настроить обновление версий через MDM</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="qkuaxh0b7aemdrmy0n3"><td>База</td><td>Не все места работы расшарены сотрудникам</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="8a0udnqgz2qmdrmy0n3"><td>Активность</td><td>Планирование сразу на несколько дней</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="o562xtjmehfmdrmy0n3"><td>Дистанционные визиты</td><td>Удаленный визит с демонстрацией CLM</td><td>Мастердата</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr><tr data-task-id="hr51syjcasrmdrmy0n3"><td>Пользователи</td><td>Из гриндаты приходит линия, но в UserDetail не обновляется.</td><td>Промомед</td><td class="priority-low">Низкий</td><td><span class="status-badge status-inprogress">В работе</span></td><td>-</td><td>-</td><td><div class="timeline-bar"><div class="timeline-progress" style="width: 0%;"><div class="timeline-text">N/A</div></div></div></td><td><button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="tooltip" aria-label="Просмотр" data-bs-original-title="Просмотр"><i class="bi bi-eye"></i></button><button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="tooltip" aria-label="Редактировать" data-bs-original-title="Редактировать"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger me-1" data-bs-toggle="tooltip" aria-label="Удалить" data-bs-original-title="Удалить"><i class="bi bi-trash"></i></button></td></tr></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Details Modal -->
    <div class="modal fade" id="taskDetailsModal" tabindex="-1" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="taskModalTitle">Редактирование: База</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="task-details">
                        <div class="row mb-2">
                            <div class="col-md-6 col-editable">
                                <strong>Категория:</strong> <span id="modalCategory" class="">База</span>
                                <span class="edit-btn" onclick="enableEdit('Category')"><i class="bi bi-pencil"></i></span>
                                <select class="form-control d-none" id="editCategory"></select>
                            </div>
                            <div class="col-md-6 col-editable">
                                <strong>Приоритет:</strong> <span id="modalPriority" class="priority-low">Низкий</span>
                                <span class="edit-btn" onclick="enableEdit('Priority')"><i class="bi bi-pencil"></i></span>
                                <select class="form-control d-none" id="editPriority">
                                    <option value="1">Высокий</option>
                                    <option value="2">Средний</option>
                                    <option value="3">Низкий</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-md-6 col-editable">
                                <strong>Ответственный:</strong> <span id="modalResponsible" class="">Мастердата</span>
                                <span class="edit-btn" onclick="enableEdit('Responsible')"><i class="bi bi-pencil"></i></span>
                                <select class="form-control d-none" id="editResponsible">
                                    <option value="Промомед">Промомед</option>
                                    <option value="Мастердата">Мастердата</option>
                                </select>
                            </div>
                            <div class="col-md-6 col-editable">
                                <strong>Статус:</strong> <span id="modalStatus" class="">-</span>
                                <span class="edit-btn" onclick="enableEdit('Status')"><i class="bi bi-pencil"></i></span>
                                <select class="form-control d-none" id="editStatus">
                                    <option value="Завершена">Завершена</option>
                                    <option value="В работе">В работе</option>
                                    <option value="В очереди">В очереди</option>
                                    <option value="Пауза">Пауза</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <strong>Дата создания:</strong> <span id="modalCreatedDate" class="">2025-07-31</span>
                            </div>
                            <div class="col-md-6">
                                <strong>Дата завершения:</strong> <span id="modalCompletedDate" class="">2025-07-31</span>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-md-6 col-editable">
                                <strong>Плановая дата завершения:</strong> <span id="modalDueDate" class="">-</span>
                                <span class="edit-btn" onclick="enableEdit('DueDate')"><i class="bi bi-pencil"></i></span>
                                <input type="date" class="form-control d-none" id="editDueDate">
                            </div>
                            <div class="col-md-6">
                                <strong>Дней на выполнение:</strong> <span id="modalDaysToComplete" class="">Выполнено за 0 д.</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12 col-editable">
                                <strong>Описание задачи:</strong>
                                <p id="modalDescription" class="">Отображение организаций и контактов только со следующими статусами:
-Активный
-Новый
-Требует дополнительной валидации
-Пустые</p>
                                <span class="edit-btn d-none" onclick="enableEdit('Description')"><i class="bi bi-pencil"></i></span>
                                <textarea class="form-control d-none" id="editDescription" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="mt-4">История обновлений:</h6>
                    <div class="modal-comments" id="modalComments"><div class="comment-item"><span class="comment-date">17.03.2025, 00:00</span><div>Завершена</div></div><div class="comment-item"><span class="comment-date">10.03.2025, 00:00</span><div>МД проверяет доступ в приложении и деактивирует все неактивные записи.</div></div></div>
                    
                    <div class="mt-3">
                        <label for="newComment" class="form-label">Добавить комментарий:</label>
                        <textarea class="form-control" id="newComment" rows="3"></textarea>
                        <button class="btn btn-primary mt-2" onclick="addComment()">Добавить</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                    <button type="button" class="btn btn-primary" id="saveChangesBtn" onclick="saveTaskChanges()">Сохранить изменения</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div class="modal fade" id="addTaskModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Добавить новую задачу</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="newTaskCategory" class="form-label">Категория:</label>
                        <input type="text" class="form-control" id="newTaskCategory" list="categoryList">
                        <datalist id="categoryList"><option value="DWH"></option><option value="Админ"></option><option value="Активность"></option><option value="Аналитика"></option><option value="База"></option><option value="Данные"></option><option value="Дистанционные визиты"></option><option value="Запросы"></option><option value="Интеграция "></option><option value="Карта"></option><option value="Контактная информация"></option><option value="Маркет циклы"></option><option value="Опросники"></option><option value="Орг структура"></option><option value="Ошибка "></option><option value="Ошибки"></option><option value="Поддержка"></option><option value="Поиск"></option><option value="Пользователи"></option><option value="Презентации"></option><option value="Приложение"></option><option value="Сервер"></option><option value="Синхронизация"></option><option value="Согласия"></option><option value="Среда"></option><option value="Таргетирование"></option></datalist>
                    </div>
                    <div class="mb-3">
                        <label for="newTaskDescription" class="form-label">Описание задачи:</label>
                        <textarea class="form-control" id="newTaskDescription" rows="3"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="newTaskResponsible" class="form-label">Ответственный:</label>
                            <select class="form-select" id="newTaskResponsible">
                                <option value="Промомед">Промомед</option>
                                <option value="Мастердата">Мастердата</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="newTaskPriority" class="form-label">Приоритет:</label>
                            <select class="form-select" id="newTaskPriority">
                                <option value="1">Высокий</option>
                                <option value="2">Средний</option>
                                <option value="3">Низкий</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="newTaskStatus" class="form-label">Статус:</label>
                            <select class="form-select" id="newTaskStatus">
                                <option value="В очереди">В очереди</option>
                                <option value="В работе">В работе</option>
                                <option value="Пауза">Пауза</option>
                                <option value="Завершена">Завершена</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="newTaskDueDate" class="form-label">Плановая дата завершения:</label>
                            <input type="date" class="form-control" id="newTaskDueDate">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="newTaskComment" class="form-label">Первоначальный комментарий:</label>
                        <textarea class="form-control" id="newTaskComment" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary" onclick="addNewTask()">Добавить задачу</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Chart Modal -->
    <div class="modal fade" id="addChartModal" tabindex="-1" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Добавить новый график</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="chartType" class="form-label">Тип графика:</label>
                        <select class="form-select" id="chartType">
                            <option value="bar">Столбчатая диаграмма</option>
                            <option value="pie">Круговая диаграмма</option>
                            <option value="line">Линейный график</option>
                            <option value="doughnut">Кольцевая диаграмма</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="chartTitle" class="form-label">Название графика:</label>
                        <input type="text" class="form-control" id="chartTitle" placeholder="Название графика">
                    </div>
                    <div class="mb-3">
                        <label for="chartDataField" class="form-label">Группировка данных (ось X / сегменты):</label>
                        <select class="form-select" id="chartDataField">
                            <option value="Категория">Категория</option>
                            <option value="Ответственный">Ответственный</option>
                            <option value="Приоритет">Приоритет</option>
                            <option value="Статус">Статус</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="chartSize" class="form-label">Размер колонки:</label>
                        <select class="form-select" id="chartSize">
                            <option value="6">Большой (50%)</option>
                            <option value="12">Полная ширина</option>
                            <option value="4">Маленький (33%)</option>
                            <option value="3">Очень маленький (25%)</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary" onclick="addNewChart()">Добавить график</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Chart Modal -->
    <div class="modal fade" id="exportChartModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Экспорт графика</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="exportFormat" class="form-label">Формат:</label>
                        <select class="form-select" id="exportFormat">
                            <option value="png">PNG</option>
                            <option value="jpeg">JPEG</option>
                            <option value="pdf">PDF</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="exportFileName" class="form-label">Имя файла:</label>
                        <input type="text" class="form-control" id="exportFileName" placeholder="Имя файла">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary" onclick="exportChart()">Экспортировать</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Global variables
        let tasks = []; // Array to store all task objects
        let currentTaskId = null; // ID of the task currently being viewed/edited in the modal
        let currentChartId = null; // ID of the chart currently being exported
        let charts = []; // Array to store chart configurations and Chart.js instances
        let currentSortColumn = 'Статус'; // Default column for sorting the task table
        let sortDirection = -1; // Default sort direction: -1 for descending, 1 for ascending
        
        // Bootstrap Modal instances
        const taskDetailsModalEl = document.getElementById('taskDetailsModal');
        const taskDetailsModal = new bootstrap.Modal(taskDetailsModalEl);
        const addTaskModalEl = document.getElementById('addTaskModal');
        const addTaskModal = new bootstrap.Modal(addTaskModalEl);
        const addChartModalEl = document.getElementById('addChartModal');
        const addChartModal = new bootstrap.Modal(addChartModalEl);
        const exportChartModalEl = document.getElementById('exportChartModal');
        const exportChartModal = new bootstrap.Modal(exportChartModalEl);
        
        // DOM element references
        const taskSearchInput = document.getElementById('taskSearch');
        const filterKpiToggle = document.getElementById('filterKpiToggle');

        // --- Helper Functions ---

        /** Generates a unique string ID. */
        function generateId() {
            return Math.random().toString(36).substring(2) + Date.now().toString(36);
        }

        /** Safely gets a value from a task object, returning '' if undefined or null. */
        function getTaskValue(task, key) {
            return task[key] || '';
        }

        /** Sets a value for a specific key in a task object. */
        function setTaskValue(task, key, value) {
            task[key] = value;
        }
        
        /** Normalizes date strings to 'YYYY-MM-DD' format, handling different parsing failures. */
        function normalizeDate(dateString) {
            if (!dateString) return ''; // Return empty string if input is empty
            let date = new Date(dateString); // Attempt to parse the date string
            if (isNaN(date.getTime())) { // If initial parsing fails, try common European formats
                const parts = dateString.split(/[.\-\/]/); // Split by '.', '-', or '/'
                if (parts.length === 3) { // Expecting DD.MM.YYYY or similar
                    date = new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0])); // Create date from parts
                }
            }
            if (isNaN(date.getTime())) return ''; // Return '' if the date is still invalid
            return date.toISOString().split('T')[0]; // Return date in 'YYYY-MM-DD' format
        }

        /** Returns today's date in 'YYYY-MM-DD' format. */
        function getTodayDate() {
            return new Date().toISOString().split('T')[0];
        }

        // --- Excel Parsing ---
        /** Parses an uploaded Excel file (.xlsx or .xls) and adds its data to the tasks array. */
        function parseExcel(file) {
            const reader = new FileReader(); // FileReader to read the file content
            reader.onload = function(e) { // Callback function when file is successfully read
                try {
                    const data = new Uint8Array(e.target.result); // Get file data as Uint8Array
                    const workbook = XLSX.read(data, { type: 'array', cellDates: true }); // Read as array buffer, enabling cell date parsing
                    const firstSheetName = workbook.SheetNames[0]; // Assume data is in the first sheet
                    const worksheet = workbook.Sheets[firstSheetName];
                    // Convert Excel sheet to JSON data, using header names and defaulting empty cells to ''
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 'H', defval: '' });

                    if (!jsonData || jsonData.length === 0) { // Validate that data was actually read
                        throw new Error('Файл не содержит данных');
                    }

                    const newlyAddedCount = addTasksFromExcel(jsonData); // Process the JSON data
                    alert(`Успешно загружено ${newlyAddedCount} новых задач.`); // Inform user about import results
                    initializeDashboard(); // Refresh the dashboard UI
                } catch (error) {
                    console.error('Ошибка при парсинге Excel файла:', error);
                    alert(`Произошла ошибка при загрузке файла: ${error.message}`);
                }
            };
            reader.onerror = function() { alert('Ошибка при чтении файла'); }; // Handle file reading errors
            reader.readAsArrayBuffer(file); // Start reading the file as an ArrayBuffer
        }

        /** Processes raw JSON data from Excel, maps headers, handles input validation, duplicate checking, and adds tasks. */
        function addTasksFromExcel(excelData) {
            let addedCount = 0; // Counter for newly added tasks
            const newTasks = []; // Temporary array for new tasks before adding to global array
            const excelHeaders = Object.keys(excelData[0] || {}).map(h => h.trim()); // Get and trim all headers from the first row
            
            // Map common Excel header names to internal task property keys (case-insensitive matching)
            const headerMappingConfig = {
                'Категория': ['Категория'],
                'Описание задачи': ['Описание задачи', 'Описание'],
                'Ответственный': ['Ответственный', 'Исполнитель'],
                'Приоритет': ['Приоритет'],
                'Статус': ['Статус'],
                'dueDate': ['Срок выполнения', 'Срок', 'Дата завершения'],
                'createdDate': ['Дата создания', 'Создана']
            };
            
            // Build a mapping from Excel header name to internal task key
            const headerMapping = {};
            excelHeaders.forEach(excelHeader => {
                for (const internalKey in headerMappingConfig) {
                    if (headerMappingConfig[internalKey].some(excelLikeHeader => excelLikeHeader.toLowerCase() === excelHeader.toLowerCase())) {
                        headerMapping[excelHeader] = internalKey; // Map the actual Excel header to the internal key
                        break; // Use the first matching internal key found
                    }
                }
            });

            excelData.forEach(rowData => { // Process each row from the Excel data
                const task = { // Initialize a new task object with a default structure
                    id: generateId(),
                    updates: [], // Array to store history of updates
                    createdDate: '',
                    dueDate: '',
                    'Категория': '',
                    'Описание задачи': '',
                    'Ответственный': '',
                    'Приоритет': '',
                    'Статус': '',
                    completedDate: '' // This is set internally when status changes to 'Завершена'
                };

                let hasEssentialData = false; // Flag to ensure Category and Description are present

                // Populate the task object based on the header mapping
                for (const excelHeader in rowData) {
                    const internalKey = headerMapping[excelHeader.trim()]; // Get the corresponding internal task key
                    if (internalKey) { // If this Excel header is mapped to a task property
                        let value = rowData[excelHeader]; // Get the value from the Excel cell
                        
                        // --- Data Type and Format Processing ---
                        if (value instanceof Date) { // If the Excel cell directly contained a Date object
                            value = value.toISOString().split('T')[0]; // Convert Date object to 'YYYY-MM-DD' string
                        } else if (typeof value === 'string' && value.trim() !== '') { // If value is a non-empty string
                            const normalized = normalizeDate(value.trim()); // Try to normalize it as a date
                            if (normalized) value = normalized; // Use normalized date if successful
                        } else if (typeof value === 'number' && (excelHeader.toLowerCase().includes('date') || excelHeader.toLowerCase().includes('срок'))) {
                            // Handle Excel's numeric date representation (e.g., OLE Automation date)
                            const dateFromNumber = new Date(Date.UTC(1899, 11, 30 + value)); // Excel epoch starts Dec 30, 1899. Adjust value accordingly.
                            if (!isNaN(dateFromNumber.getTime())) { // Check if date conversion was successful
                                value = dateFromNumber.toISOString().split('T')[0]; // Format as 'YYYY-MM-DD'
                            }
                        }
                        
                        setTaskValue(task, internalKey, value); // Set the processed value in the task object
                        // Mark as having essential data if Category or Description are filled
                        if ((internalKey === 'Категория' || internalKey === 'Описание задачи') && value && value.toString().trim() !== '') {
                            hasEssentialData = true;
                        }
                    }
                }
                
                // Process updates/comments from columns that look like dates (e.g., "2023-01-01 12:00:00")
                for (const excelHeader in rowData) {
                    if (!headerMapping[excelHeader]) { // If this header isn't mapped to a standard field
                        const value = rowData[excelHeader];
                        if (value && value.toString().trim() !== '') { // If the cell has content
                            try {
                                // Try to parse the header as a date (assuming it's a timestamp for updates)
                                const date = new Date(excelHeader);
                                if (!isNaN(date.getTime())) { // If the header is a valid date
                                    const dateString = date.toISOString().split('T')[0] + ' ' + date.toLocaleTimeString('ru-RU');
                                    task.updates.push({
                                        date: dateString,
                                        comment: value.toString().trim()
                                    });
                                }
                            } catch (e) {
                                console.log('Skipping non-date column:', excelHeader);
                            }
                        }
                    }
                }
                
                // Skip the row if it lacks essential data (Category or Description)
                if (!hasEssentialData) return; 

                // Prevent adding duplicate tasks if a task with the same Category and Description already exists
                const isDuplicate = tasks.some(existingTask =>
                    getTaskValue(existingTask, 'Категория') === getTaskValue(task, 'Категория') &&
                    getTaskValue(existingTask, 'Описание задачи') === getTaskValue(task, 'Описание задачи')
                );
                if (isDuplicate) return; // Skip this row if it's a duplicate

                // If no creation date was provided, default to today's date
                if (!task.createdDate) {
                    task.createdDate = getTodayDate();
                }
                
                // If the status is 'Завершена' and completedDate is missing, set it logically
                if (getTaskValue(task, 'Статус') === 'Завершена' && !task.completedDate) {
                    // Use the dueDate if available, otherwise use createdDate as the completion date
                    task.completedDate = task.dueDate || task.createdDate;
                }

                newTasks.push(task); // Add the processed task to the list of new tasks to be added
                addedCount++; // Increment the count of tasks added
            });
            tasks.push(...newTasks); // Add all processed new tasks to the main `tasks` array
            return addedCount; // Return the total number of tasks added
        }
        
        // --- KPI Functions ---
        /** Updates the KPI cards (Total, Completed, In Progress, Overdue) based on current filters. */
        function updateKPIs() {
            // Decide which set of tasks to use for KPI calculations: filtered or all
            const tasksForKPI = filterKpiToggle.checked ? getFilteredTasks() : tasks;
            
            // Calculate counts for each KPI
            const total = tasksForKPI.length; // Total tasks
            const completed = tasksForKPI.filter(task => getTaskValue(task, 'Статус') === 'Завершена').length; // Tasks marked as 'Завершена'
            const inProgress = tasksForKPI.filter(task => getTaskValue(task, 'Статус') === 'В работе').length; // Tasks marked as 'В работе'
            
            const today = new Date(); // Get today's date
            today.setHours(0, 0, 0, 0); // Normalize to the start of the day for accurate date comparisons
            
            const overdue = tasksForKPI.filter(task => { // Count overdue tasks
                const taskStatus = getTaskValue(task, 'Статус');
                if (taskStatus === 'Завершена') return false; // Completed tasks are not considered overdue
                const dueDate = getTaskValue(task, 'dueDate');
                if (!dueDate) return false; // Tasks without a due date are not counted as overdue
                const taskDueDate = new Date(dueDate); // Convert due date string to Date object
                return taskDueDate < today; // Check if the due date is before today
            }).length;

            // Update the text content of the respective KPI elements
            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('inProgressTasks').textContent = inProgress;
            document.getElementById('overdueTasks').textContent = overdue;
        }

        // --- Chart Functions ---
        /** Initializes the charts area: clears existing charts, loads saved ones from localStorage, and adds default charts if none are found. */
        function initializeCharts() {
            const chartsRow = document.getElementById('chartsRow');
            chartsRow.innerHTML = ''; // Clear the charts container before re-rendering
            charts = []; // Reset the global charts array to clear previous instances

            // Load chart configurations from localStorage
            const savedCharts = JSON.parse(localStorage.getItem('crmDashboardCharts')) || [];
            // Recreate charts from saved configurations. `saveToStorage: false` prevents immediate re-saving.
            savedCharts.forEach(c => addChart(c.id, c.title, c.type, c.dataField, c.size, false));

            // If no charts were loaded from localStorage (e.g., first run or localStorage cleared), add default charts
            if (charts.length === 0) { 
                addChart('statusChart', 'Задачи по статусам', 'doughnut', 'Статус', 6);
                addChart('categoryChart', 'Задачи по категориям', 'bar', 'Категория', 6);
            }
        }
        
        /**
         * Adds a new chart visualization to the dashboard. Renders the chart and sets up its interactivity.
         * @param {string} id Unique ID for the chart's canvas element.
         * @param {string} title The title of the chart.
         * @param {'bar'|'pie'|'line'|'doughnut'} type The type of chart to render.
         * @param {string} dataField The task property to group data by (e.g., 'Статус', 'Категория').
         * @param {number} size Bootstrap column size (1-12) for the chart's container.
         * @param {boolean} [saveToStorage=true] If true, saves this chart's configuration to localStorage.
         * @returns {object|null} The created Chart.js instance object, or null if an error occurred.
         */
        function addChart(id, title, type, dataField, size, saveToStorage = true) {
            try {
                const chartsRow = document.getElementById('chartsRow'); // Get the container for all chart columns
                // Create a column div that will hold the chart card
                const col = document.createElement('div');
                col.className = `col-md-${size}`; // Set the Bootstrap column size
                col.id = `col-${id}`; // Assign an ID to the column container
                col.setAttribute('draggable', true); // Make the column draggable for reordering
                col.dataset.chartId = id; // Store the chart's ID as a data attribute for easy reference

                // Define the HTML structure for the chart card, including title, action buttons, and canvas placeholder
                col.innerHTML = `
                    <div class="card chart-card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">${title}</h5>
                            <div class="d-flex align-items-center">
                                <button class="btn btn-sm btn-outline-secondary me-2 export-chart-btn" data-bs-toggle="tooltip" title="Экспорт графика" data-chart-id="${id}">
                                    <i class="bi bi-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger delete-chart-btn" data-bs-toggle="tooltip" title="Удалить график" data-chart-id="${id}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="${id}"></canvas> <!-- The canvas element where Chart.js will render the chart -->
                            </div>
                        </div>
                    </div>
                `;
                chartsRow.appendChild(col); // Append the new chart column to the DOM
                
                // Initialize Bootstrap tooltips for the action buttons
                new bootstrap.Tooltip(col.querySelector('.export-chart-btn'));
                new bootstrap.Tooltip(col.querySelector('.delete-chart-btn'));

                // --- Data Preparation for Chart ---
                const filteredTasks = getFilteredTasks(); // Get tasks based on the current filter settings
                // Extract unique labels from tasks based on the specified 'dataField', filter out empty ones, and sort them
                const labels = [...new Set(filteredTasks.map(task => getTaskValue(task, dataField)))]
                                .filter(Boolean) // Remove null or empty labels
                                .sort((a, b) => { // Sort labels either numerically or alphabetically
                                    if (!isNaN(a) && !isNaN(b)) return Number(a) - Number(b); // Numeric sort for numbers
                                    return String(a).localeCompare(String(b)); // Alphabetical sort for strings
                                });
                // Count the occurrences of each unique label
                const data = labels.map(label =>
                    filteredTasks.filter(task => getTaskValue(task, dataField) === label).length
                );
                
                // --- Chart.js Instance Creation ---
                const ctx = document.getElementById(id)?.getContext('2d'); // Get the 2D rendering context for the canvas element
                if (!ctx) { // Critical check: if canvas context is not available, chart cannot be created
                    console.error(`Canvas context not found for chart ID '${id}'. Ensure the canvas element is correctly rendered.`);
                    return null; // Return null to indicate failure
                }

                const chartInstance = new Chart(ctx, { // Create a new Chart.js instance
                    type: type, // Specify the chart type (e.g., 'bar')
                    data: { // Define the data for the chart
                        labels: labels, // Labels for axes or segments
                        datasets: [{ // One or more datasets for the chart
                            label: 'Количество задач', // Label for the dataset in tooltips/legends
                            data: data, // The actual numerical data
                            backgroundColor: getChartColors(type, labels.length), // Get appropriate background colors
                            borderColor: getChartColors(type, labels.length).map(color => color.replace('0.6', '1')), // Get darker border colors
                            borderWidth: 1 // Border width for elements
                        }]
                    },
                    options: { // Chart configuration options
                        responsive: true, // Enable responsiveness
                        maintainAspectRatio: false, // Allow chart to fill its container without maintaining aspect ratio
                        plugins: { // Chart.js plugin configurations
                            legend: { // Legend settings
                                position: ['pie', 'doughnut'].includes(type) ? 'right' : 'top', // Position legend based on chart type
                                labels: { font: { size: 12 } } // Set font size for legend labels
                            },
                            title: { // Chart title settings
                                display: true,
                                text: title,
                                font: { size: 14, weight: 'bold' },
                                padding: { top: 10, bottom: 10 }
                            },
                            tooltip: { // Tooltip settings
                                enabled: true,
                                titleFont: { size: 13 },
                                bodyFont: { size: 12 }
                            }
                        },
                        animation: { // Animation settings for chart rendering
                            duration: 800, // Duration in milliseconds
                            easing: 'easeInOutQuart' // Easing function for smooth animation
                        },
                        interaction: { // Interaction settings for tooltips
                            mode: 'index', // Tooltip follows the index across datasets
                            intersect: false, // Tooltip appears even if mouse doesn't directly intersect the data point,
                        },
                        scales: type === 'bar' ? { // Configure scales specifically for bar charts
                            y: { ticks: { font: { size: 12 } } }, // Y-axis tick label font size
                            x: { ticks: { font: { size: 12 } } }  // X-axis tick label font size
                        } : {} // No scales configuration needed for pie/doughnut charts
                    }
                });

                // Store the chart instance and its configuration in the global `charts` array
                charts.push({ id, title, type, dataField, size, chartInstance });
                
                // Add event listeners for chart action buttons (export, delete)
                const exportBtn = col.querySelector(`.export-chart-btn[data-chart-id="${id}"]`);
                const deleteBtn = col.querySelector(`.delete-chart-btn[data-chart-id="${id}"]`);
                
                if (exportBtn) { // Add listener for the export button
                    exportBtn.addEventListener('click', () => {
                        currentChartId = id; // Set the current chart ID for the export modal
                        document.getElementById('exportFileName').value = title; // Pre-fill the filename input
                        exportChartModal.show(); // Show the export modal
                    });
                }

                if (deleteBtn) { // Add listener for the delete button
                    deleteBtn.addEventListener('click', () => {
                        // Prompt user for confirmation before deleting
                        if (confirm(`Удалить график "${title}"?`)) {
                            const chartIndex = charts.findIndex(c => c.id === id); // Find the index of the chart to remove
                            if (chartIndex !== -1) {
                                charts[chartIndex].chartInstance.destroy(); // Destroy the Chart.js instance to free resources
                                charts.splice(chartIndex, 1); // Remove the chart object from the `charts` array
                            }
                            col.remove(); // Remove the chart's HTML element from the DOM
                            if (saveToStorage) saveDashboardConfig(); // Save updated configuration if this was a user-added chart
                        }
                    });
                }
                
                // Add drag and drop event listeners to make chart columns reorderable
                col.addEventListener('dragstart', handleDragStart);
                col.addEventListener('dragover', handleDragOver);
                col.addEventListener('dragleave', handleDragLeave);
                col.addEventListener('drop', handleDrop);

                if (saveToStorage) saveDashboardConfig(); // Save the configuration if this is a new chart added by the user
                return { id, title, type, dataField, size, chartInstance }; // Return the created chart object

            } catch (error) { // Catch any errors during chart creation
                console.error(`Ошибка при создании графика '${title}':`, error);
                alert(`Не удалось создать график "${title}". Проверьте консоль для деталей.`);
                return null; // Return null to indicate an error occurred
            }
        }
        
        /** Provides color palettes for charts, generating distinct HSL colors for pie/doughnut charts. */
        function getChartColors(type, count) {
            // Base palette for bar, line, etc. charts
            const colors = [
                '#007bff', '#28a745', '#ffc107', '#dc3545', '#17a2b8', '#6c757d', '#fd7e14', '#198754', '#0dcaf0', '#6f42c1'
            ];
            // Dynamically generate colors for pie and doughnut charts for better visual distinction
            if (type === 'pie' || type === 'doughnut') {
                const dynamicColors = [];
                for (let i = 0; i < count; i++) {
                    const hue = (i * 360 / count) % 360; // Distribute hue evenly across the color spectrum
                    // Vary lightness slightly to make segments more distinguishable
                    dynamicColors.push(`hsl(${hue}, 70%, ${60 + (i % 2 * 10)}%)`);
                }
                return dynamicColors;
            }
            // For other chart types, repeat the base palette to ensure enough colors if 'count' is large
            const palette = colors.concat(colors, colors, colors, colors, colors);
            return palette.slice(0, count); // Return the required number of colors from the palette
        }

        /** Updates all existing charts with the latest filtered data and re-renders them. */
        function updateCharts() {
            if (!charts || charts.length === 0) return; // Exit if there are no charts to update

            charts.forEach(chartData => { // Iterate through each chart
                try { // Wrap chart update logic in a try-catch block for error handling
                    const filteredTasks = getFilteredTasks(); // Get tasks based on current filters
                    
                    // Prepare labels: Extract unique values from tasks based on the chart's dataField, filter out empty ones, and sort them
                    const labels = [...new Set(filteredTasks.map(task => getTaskValue(task, chartData.dataField)))]
                                    .filter(Boolean) // Remove any null or empty labels
                                    .sort((a, b) => { // Sort labels numerically or alphabetically
                                        if (!isNaN(a) && !isNaN(b)) return Number(a) - Number(b); // Numeric sort
                                        return String(a).localeCompare(String(b)); // Alphabetical sort
                                    });
                    
                    // Count the occurrences of each unique label
                    const data = labels.map(label =>
                        filteredTasks.filter(task => getTaskValue(task, chartData.dataField) === label).length
                    );
                    
                    // Update the Chart.js instance's data with the newly prepared labels and counts
                    chartData.chartInstance.data.labels = labels;
                    chartData.chartInstance.data.datasets[0].data = data;
                    // Update colors based on the new number of labels
                    chartData.chartInstance.data.datasets[0].backgroundColor = getChartColors(chartData.type, labels.length);
                    chartData.chartInstance.data.datasets[0].borderColor = getChartColors(chartData.type, labels.length).map(color => color.replace('0.6', '1'));
                    chartData.chartInstance.update(); // Re-render the chart
                } catch (error) { // Log any errors encountered during the update process
                    console.error(`Error updating chart '${chartData.title}':`, error);
                }
            });
        }

        // --- Table Functions ---
        /** Initializes or re-renders the task table: sets up headers, sorts data, and creates table rows. */
        function initializeTable() {
            const tableHead = document.getElementById('tasksTableHead');
            const tableBody = document.getElementById('tasksTableBody');
            tableBody.innerHTML = ''; // Clear the table body before repopulating
            
            // Make table headers sortable by adding click handlers and resetting previous sort indicators
            tableHead.querySelectorAll('th[data-column]').forEach(th => {
                th.style.cursor = 'pointer'; // Indicate that the header is clickable
                th.onclick = () => sortTasks(th.dataset.column); // Attach the sortTasks function to the click event
                th.classList.remove('sorted-asc', 'sorted-desc'); // Remove any previous sorting indicator classes
                const existingIcon = th.querySelector('.sort-icon'); // Find and remove any existing sort icon
                if (existingIcon) existingIcon.remove();
            });

            const filteredTasks = getFilteredTasks(); // Get the tasks that match the current filter criteria

            // If no tasks match the filters, display a message in the table
            if (filteredTasks.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="9" class="text-center text-muted py-4">Нет задач, соответствующих выбранным фильтрам.</td>';
                return tableBody.appendChild(row); // Append the message row and exit
            }
            
            // Sort the filtered tasks based on the current sort column and direction
            filteredTasks.sort((a, b) => {
                const valueA = getTaskValue(a, currentSortColumn); // Get value from task A for comparison
                const valueB = getTaskValue(b, currentSortColumn); // Get value from task B for comparison

                // Define specific sorting logic based on column type
                if (currentSortColumn === 'Приоритет') {
                    const prioA = parseInt(valueA) || 3; // Default to Low priority (3) if value is missing/invalid
                    const prioB = parseInt(valueB) || 3;
                    return (prioA - prioB) * sortDirection; // Sort numerically
                } else if (currentSortColumn === 'Статус') {
                    // Define a sort order for statuses to group them logically
                    const statusOrder = { 'Завершена': 0, 'В работе': 1, 'В очереди': 2, 'Пауза': 3 };
                    const statusA = statusOrder[valueA] || 4; // Default to Undefined (4) if status is not in the list
                    const statusB = statusOrder[valueB] || 4;
                    return (statusA - statusB) * sortDirection; // Sort according to the defined order
                } else if (currentSortColumn === 'dueDate') {
                    // Sort by due date, treating missing dates as the earliest possible
                    const dateA = valueA ? new Date(valueA) : new Date(0); // Use epoch start (Jan 1, 1970) for missing dates
                    const dateB = valueB ? new Date(valueB) : new Date(0);
                    return (dateA - dateB) * sortDirection; // Sort chronologically
                } else {
                    // Default to case-insensitive string comparison for all other columns
                    return String(valueA).localeCompare(String(valueB)) * sortDirection;
                }
            });

            // Add the sorting indicator icon to the header of the currently sorted column
            const currentColHeader = tableHead.querySelector(`th[data-column="${currentSortColumn}"]`);
            if (currentColHeader) {
                currentColHeader.classList.add(sortDirection === 1 ? 'sorted-asc' : 'sorted-desc'); // Add class for styling
                const icon = document.createElement('i'); // Create an icon element
                icon.className = `bi bi-arrow-${sortDirection === 1 ? 'up' : 'down'} sort-icon`; // Set icon based on the sort direction
                currentColHeader.appendChild(icon); // Append the icon to the header cell
            }

            // Iterate through the sorted tasks and create a table row (`<tr>`) for each
            filteredTasks.forEach(task => {
                const row = document.createElement('tr');
                row.dataset.taskId = task.id; // Store the task ID on the row for easy reference

                // Apply row styling based on due date status, but only if the task is not completed
                if (getTaskValue(task, 'Статус') !== 'Завершена') {
                    const rowClass = getRowClass(task); // Get the appropriate CSS class ('overdue', 'due-soon', etc.)
                    if (rowClass) row.classList.add(rowClass); // Apply the class if it exists
                }

                // Append cells (`<td>`) for each piece of task data
                row.appendChild(createCell(getTaskValue(task, 'Категория'), 'td')); // Category cell
                
                const descriptionCell = createCell(getTaskValue(task, 'Описание задачи'), 'td'); // Description cell
                highlightText(descriptionCell, taskSearchInput.value); // Highlight search term in description if any
                row.appendChild(descriptionCell);

                row.appendChild(createCell(getTaskValue(task, 'Ответственный'), 'td')); // Responsible cell

                // Priority cell - display text and apply color class based on priority level
                const priorityValue = getTaskValue(task, 'Приоритет');
                const priorityText = priorityValue === '1' ? 'Высокий' : priorityValue === '2' ? 'Средний' : 'Низкий';
                const priorityCell = createCell(priorityText, 'td');
                priorityCell.classList.add(priorityValue === '1' ? 'priority-high' : priorityValue === '2' ? 'priority-medium' : 'priority-low'); // Add priority-specific class for color
                row.appendChild(priorityCell);

                // Status cell - display status as a styled badge
                const statusValue = getTaskValue(task, 'Статус');
                const statusCell = createCell('', 'td'); // Create an empty cell to hold the badge span
                const statusBadge = document.createElement('span'); // Create the span element for the badge
                statusBadge.classList.add('status-badge'); // Add base badge styling
                statusBadge.textContent = statusValue || 'Не указан'; // Set badge text
                statusBadge.classList.add(getStatusBadgeClass(statusValue)); // Add status-specific class for background color
                statusCell.appendChild(statusBadge); // Place the badge within the cell
                row.appendChild(statusCell);

                // Due Date cell - display date or '-' if missing
                row.appendChild(createCell(getTaskValue(task, 'dueDate') || '-', 'td'));

                // Days to Complete / Rendered Days cell - displays calculated time information
                row.appendChild(createCell(getTaskToDaysToComplete(task), 'td'));

                // Progress Bar cell
                const progressBarCell = createCell('', 'td'); // Cell to contain the progress bar
                progressBarCell.appendChild(createProgressBar(task)); // Create and append the progress bar element
                row.appendChild(progressBarCell);

                // Actions cell - contains buttons for View, Edit, Delete
                const actionsCell = createCell('', 'td');
                actionsCell.appendChild(createActionButton('<i class="bi bi-eye"></i>', 'btn-outline-primary', () => viewTaskDetails(task.id))); // View button
                actionsCell.appendChild(createActionButton('<i class="bi bi-pencil"></i>', 'btn-outline-secondary', () => editTask(task.id))); // Edit button
                actionsCell.appendChild(createActionButton('<i class="bi bi-trash"></i>', 'btn-outline-danger', () => deleteTask(task.id))); // Delete button
                row.appendChild(actionsCell);

                tableBody.appendChild(row); // Append the completed row to the table body
            });
        }

        /** Creates a table cell (`<td>` or `<th>`) and populates it with the given content. */
        function createCell(content, tagName = 'td') {
            const cell = document.createElement(tagName);
            if (typeof content === 'string') {
                cell.innerHTML = content; // Use innerHTML if content is a string to allow rendering HTML tags
            } else {
                cell.appendChild(content); // Append the DOM element if content is not a string
            }
            return cell;
        }

        /** Creates an action button for a table row with an icon and click handler. */
        function createActionButton(iconHtml, btnClass, onClick) {
            const button = document.createElement('button');
            button.className = `btn btn-sm ${btnClass} me-1`; // Apply Bootstrap button styling classes
            button.innerHTML = iconHtml; // Set the button's content (usually an icon)
            let tip = ''; // Tooltip text for the button
            if(iconHtml.includes('eye')) tip = 'Просмотр';
            else if(iconHtml.includes('pencil')) tip = 'Редактировать';
            else if(iconHtml.includes('trash')) tip = 'Удалить';
            button.setAttribute('data-bs-toggle', 'tooltip'); // Enable Bootstrap tooltip functionality
            button.setAttribute('title', tip); // Set the tooltip text
            button.onclick = onClick; // Assign the click handler function
            return button;
        }
        
        /** Creates a visual progress bar element for a task. */
        function createProgressBar(task) {
            const progressBarDiv = document.createElement('div');
            progressBarDiv.className = 'timeline-bar'; // Outer container for the progress bar
            
            const progress = document.createElement('div');
            progress.className = 'timeline-progress'; // The inner element that fills to show progress
            
            const progressText = document.createElement('div');
            progressText.className = 'timeline-text'; // Text element to display the percentage
            
            let progressPercent = 0; // Initialize progress percentage
            const taskStatus = getTaskValue(task, 'Статус'); // Get the current status of the task

            // Calculate progress only if the task has both a due date and a creation date
            if (getTaskValue(task, 'dueDate') && getTaskValue(task, 'createdDate')) {
                const createdDate = new Date(getTaskValue(task, 'createdDate'));
                const dueDate = new Date(getTaskValue(task, 'dueDate'));
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Normalize today's date to the start of the day
                
                // Calculate the total duration in days between creation and due date. Ensure it's at least 1 day to prevent division by zero.
                const totalDays = Math.max(1, Math.floor(Math.abs(dueDate - createdDate) / (1000 * 60 * 60 * 24)));
                
                let daysCount = 0; // Counter for days elapsed for progress calculation

                // Determine how many days have passed based on the task's status
                if (taskStatus === 'Завершена' && task.completedDate) { // If the task is completed
                    const completedDate = new Date(task.completedDate);
                    // Calculate days from creation date to completion date
                    daysCount = Math.floor((completedDate - createdDate) / (1000 * 60 * 60 * 24));
                } else { // If the task is not completed
                    // Calculate days from creation date until today
                    daysCount = Math.floor((today - createdDate) / (1000 * 60 * 60 * 24));
                }

                progressPercent = (daysCount / totalDays) * 100; // Calculate the progress percentage
                progressPercent = Math.min(Math.max(progressPercent, 0), 100); // Clamp the percentage between 0 and 100
                
                progress.style.width = `${progressPercent}%`; // Set the width of the progress fill element
                progressText.textContent = `${Math.round(progressPercent)}%`; // Display the calculated percentage
            } else { // If dates are unavailable, display 'N/A'
                progress.style.width = '0%';
                progressText.textContent = 'N/A';
            }
            
            progress.appendChild(progressText); // Add the percentage text to the progress element
            progressBarDiv.appendChild(progress); // Add the progress fill element to the progress bar container
            return progressBarDiv; // Return the fully constructed progress bar element
        }

        /** Returns a CSS class name for a table row based on the task's due date status (overdue, due soon, on track). */
        function getRowClass(task) {
            const dueDateStr = getTaskValue(task, 'dueDate'); // Get the task's due date string
            if (!dueDateStr) return ''; // Return empty string if no due date is set

            const today = new Date(); // Get today's date
            today.setHours(0, 0, 0, 0); // Normalize to the start of the day
            const dueDate = new Date(dueDateStr); // Parse the due date string into a Date object
            
            // Calculate the difference in days between the due date and today
            const timeDiff = dueDate.getTime() - today.getTime();
            const daysDiff = Math.floor(timeDiff / (1000 * 60 * 60 * 24)); // Convert milliseconds to days

            if (daysDiff < 0) return 'overdue'; // If the due date is in the past
            if (daysDiff <= 3) return 'due-soon'; // If the due date is within the next 3 days (inclusive of today)
            return 'on-track'; // If the due date is more than 3 days away
        }

        /** Returns the appropriate CSS class for a status badge based on the status text. */
        function getStatusBadgeClass(status) {
            switch (status) {
                case 'Завершена': return 'status-completed';
                case 'В работе': return 'status-inprogress';
                case 'Пауза': return 'status-paused';
                case 'В очереди': return 'status-queued';
                default: return 'status-queued'; // Default class for any unknown or empty status
            }
        }
        
        /** Returns formatted text for the "Days to Complete" column in the task table. */
        function getTaskToDaysToComplete(task) {
            const createdDateStr = getTaskValue(task, 'createdDate');
            const dueDateStr = getTaskValue(task, 'dueDate');
            const completedDateStr = task.completedDate; // This is set internally when status changes to 'Завершена'

            // If the task is completed and relevant dates are available
            if (getTaskValue(task, 'Статус') === 'Завершена' && createdDateStr && completedDateStr) {
                const created = new Date(createdDateStr);
                const completed = new Date(completedDateStr);
                if (!isNaN(created.getTime()) && !isNaN(completed.getTime())) { // Ensure dates are valid
                    const diffDays = Math.floor((completed - created) / (1000 * 60 * 60 * 24)); // Calculate days spent
                    return `Выполнено за ${diffDays} д.`; // Format output string
                }
            } else if (dueDateStr && createdDateStr) { // If the task is not completed but has dates
                const created = new Date(createdDateStr);
                const due = new Date(dueDateStr);
                if (!isNaN(created.getTime()) && !isNaN(due.getTime())) { // Ensure dates are valid
                    const diffDays = Math.floor((due - created) / (1000 * 60 * 60 * 24)); // Calculate days from creation to due date
                    return `Срок: ${diffDays} д.`; // Format output string
                }
            }
            return '-'; // Return '-' if dates are missing or invalid
        }

        // --- Filtering and Sorting ---
        /** Applies all active filters to the task table and updates charts/KPIs accordingly. */
        function applyFilters() {
            initializeTable(); // Re-render the table with potentially new filtered data
            updateCharts();    // Update charts to reflect the filtered data
            updateKPIs();      // Refresh the KPI counts based on the filtered data
        }

        /** Resets all filter controls and the search input, then reapplies filters to show all tasks. */
        function resetFilters() {
            // Deselect all options in the multi-select filter elements
            document.getElementById('categoryFilter').querySelectorAll('option').forEach(option => option.selected = false);
            document.getElementById('statusFilter').querySelectorAll('option').forEach(option => option.selected = false);
            document.getElementById('responsibleFilter').querySelectorAll('option').forEach(option => option.selected = false);
            document.getElementById('priorityFilter').querySelectorAll('option').forEach(option => option.selected = false);
            document.getElementById('dueStatusFilter').querySelectorAll('option').forEach(option => option.selected = false);
            
            taskSearchInput.value = ''; // Clear the search input field
            applyFilters(); // Apply the filters (which now effectively show all tasks because all selections are cleared)
        }

        /**
         * Sorts the tasks array based on the specified column name. Toggles sort direction if the same column is clicked.
         * @param {string} columnName The `data-column` attribute value of the header to sort by.
         */
        function sortTasks(columnName) {
            if (currentSortColumn === columnName) { // If the same column header was clicked again
                sortDirection *= -1; // Reverse the sort direction (ascending <-> descending)
            } else { // If a new column header was clicked
                currentSortColumn = columnName; // Set the new column to sort by
                sortDirection = 1; // Reset sort direction to ascending (default)
            }
            initializeTable(); // Re-render the table with the newly sorted data
        }

        /** Filters the global `tasks` array based on the current filter selections and the search input. */
        function getFilteredTasks() {
            // Get selected values from all multi-select filter elements
            const categoryFilter = Array.from(document.getElementById('categoryFilter').selectedOptions).map(opt => opt.value);
            const statusFilter = Array.from(document.getElementById('statusFilter').selectedOptions).map(opt => opt.value);
            const responsibleFilter = Array.from(document.getElementById('responsibleFilter').selectedOptions).map(opt => opt.value);
            const priorityFilter = Array.from(document.getElementById('priorityFilter').selectedOptions).map(opt => opt.value);
            const dueStatusFilter = Array.from(document.getElementById('dueStatusFilter').selectedOptions).map(opt => opt.value);
            const searchTerm = taskSearchInput.value.trim().toLowerCase(); // Get and trim the search term from the input

            const today = new Date(); // Get today's date
            today.setHours(0, 0, 0, 0); // Normalize to the start of the day for accurate date comparisons
            
            // Filter the global `tasks` array
            return tasks.filter(task => {
                // Check if the task matches each filter criterion. If a filter is not applied (no options selected), it always matches.
                const categoryMatch = categoryFilter.length === 0 || categoryFilter.includes(getTaskValue(task, 'Категория'));
                const statusMatch = statusFilter.length === 0 || statusFilter.includes(getTaskValue(task, 'Статус'));
                const responsibleMatch = responsibleFilter.length === 0 || responsibleFilter.includes(getTaskValue(task, 'Ответственный'));
                const priorityMatch = priorityFilter.length === 0 || priorityFilter.includes(getTaskValue(task, 'Приоритет'));
                // Check if the task description contains the search term (case-insensitive)
                const descriptionMatch = !searchTerm || getTaskValue(task, 'Описание задачи').toLowerCase().includes(searchTerm);

                // Check if the task matches the due date status filter
                let dueStatusMatch = dueStatusFilter.length === 0; // Default to true if no 'due status' filters are selected
                if (dueStatusFilter.length > 0) { // If specific 'due status' filters are applied
                    const taskHasDueDate = getTaskValue(task, 'dueDate'); // Check if the task has a due date
                    const taskStatus = getTaskValue(task, 'Статус'); // Get the current status of the task
                    
                    // Condition for tasks without a due date matching the filter
                    if (!taskHasDueDate && dueStatusFilter.includes('no-due-date')) {
                        dueStatusMatch = true;
                    } else if (taskHasDueDate) { // If the task has a due date
                        const dueDate = new Date(getTaskValue(task, 'dueDate')); // Parse the due date
                        // Calculate the difference in days between the due date and today
                        const daysDiff = Math.floor((dueDate - today) / (1000 * 60 * 60 * 24));
                        
                        // Check if the task meets any of the selected criteria ('overdue', 'due-soon', 'on-track') and is not completed
                        if (dueStatusFilter.includes('overdue') && daysDiff < 0 && taskStatus !== 'Завершена') {
                            dueStatusMatch = true;
                        } else if (dueStatusFilter.includes('due-soon') && daysDiff >= 0 && daysDiff <= 3 && taskStatus !== 'Завершена') {
                            dueStatusMatch = true;
                        } else if (dueStatusFilter.includes('on-track') && daysDiff > 3 && taskStatus !== 'Завершена') {
                            dueStatusMatch = true;
                        }
                    }
                }
                
                // The task must satisfy all filter conditions to be included in the filtered result
                return categoryMatch && statusMatch && responsibleMatch && priorityMatch && descriptionMatch && dueStatusMatch;
            });
        }

        /** Highlights the search term within the text content of a given element. */
        function highlightText(element, text) {
            if (!text || text.length === 0) { // If search text is empty or null, remove any existing highlights
                element.innerHTML = element.textContent; // Restore original text from textContent
                return;
            }
            // Create a regular expression to find the search term globally and case-insensitively
            const regex = new RegExp(`(${text.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi'); // Escape special regex characters in the search term
            // Replace found occurrences with the same text wrapped in a highlight span (using Bootstrap's warning bg)
            element.innerHTML = element.innerHTML.replace(regex, '<span class="bg-warning bg-opacity-25">$1</span>');
        }

        // --- Task Management ---
        /** Displays task details in a modal for viewing purposes. */
        function viewTaskDetails(taskId) {
            const task = tasks.find(t => t.id === taskId); // Find the task by its ID
            if (!task) return; // Exit if the task is not found
            
            currentTaskId = taskId; // Set the current task ID for modal operations
            
            document.getElementById('taskModalTitle').textContent = `Задача: ${getTaskValue(task, 'Категория') || 'Без категории'}`; // Set the modal title
            
            // Populate the modal's fields with task data using the displayTaskField helper
            displayTaskField('Category', task, 'Категория');
            displayTaskField('Description', task, 'Описание задачи');
            displayTaskField('Responsible', task, 'Ответственный');
            // Priority display with text formatting and CSS class for styling
            displayTaskField('Priority', task, 'Приоритет', (val) => {
                if (val === '1') return { text: 'Высокий', class: 'priority-high' };
                if (val === '2') return { text: 'Средний', class: 'priority-medium' };
                return { text: 'Низкий', class: 'priority-low' };
            });
            // Status display as a styled badge
            displayTaskField('Status', task, 'Статус', (val) => {
                const badge = document.createElement('span'); // Create a span for the badge
                badge.classList.add('status-badge', getStatusBadgeClass(val)); // Apply base and status-specific classes
                badge.textContent = val || 'Не указан'; // Set badge text
                return badge; // Return the badge element
            });
            displayTaskField('CreatedDate', task, 'createdDate'); // Display creation date
            displayTaskField('DueDate', task, 'dueDate'); // Display due date
            displayTaskField('CompletedDate', task, 'completedDate'); // Display completion date
            // Display the calculated 'Days to Complete' or remaining days until due
            displayTaskField('DaysToComplete', task, null, () => getTaskToDaysToComplete(task)); 

            populateComments(task); // Populate the task's history/comments section
            
            document.getElementById('saveChangesBtn').classList.add('d-none'); // Hide the "Save Changes" button in view mode
            taskDetailsModal.show(); // Show the task details modal
        }
        
        /**
         * Helper to populate modal fields with task data, managing display elements, edit elements,
         * and the visibility of edit buttons.
         * @param {string} FieldName The name of the field (e.g., 'Category', capitalized) used to find related HTML elements.
         * @param {object} task The task object containing the data.
         * @param {string|null} taskKey The key in the task object to retrieve data from (e.g., 'Категория'). Null if the field is calculated.
         * @param {function|null} [formatter=null] An optional function to format the display value and add CSS classes.
         */
        function displayTaskField(fieldName, task, taskKey, formatter = null) {
            const modalField = document.getElementById(`modal${fieldName}`); // The display element (e.g., `modalCategory`)
            const editField = document.getElementById(`edit${fieldName}`); // The edit element (e.g., `editCategory`)
            // Find the edit button associated with this field (e.g., `onclick="enableEdit('category')"`)
            const editBtn = document.querySelector(`[onclick*="enableEdit('${fieldName[0].toLowerCase() + fieldName.slice(1)}')"]`);
            
            let displayValue = '-'; // Default display value if no value is found or formatted
            let displayClass = '';  // Default CSS classes for the display element
            let editValue = '';     // Value to set in the edit element (e.g., input value, select value)

            if (taskKey) { // If a taskKey is provided, retrieve data using it
                const rawValue = getTaskValue(task, taskKey); // Get the raw value from the task object
                editValue = rawValue; // Use the raw value for the edit control
                
                if (formatter) { // If a formatter function is provided
                    const formatted = formatter(rawValue, task); // Call the formatter function
                    if (typeof formatted === 'object' && formatted !== null) { // If formatter returns an object { text, class }
                        displayValue = formatted.text || '-'; // Use the formatted text
                        displayClass = formatted.class || ''; // Use the formatted CSS classes
                    } else { // If formatter returns a simple string
                        displayValue = formatted || '-'; // Use the formatted string or the default value
                    }
                } else { // If no formatter is provided
                    displayValue = rawValue || '-'; // Use the raw value or the default '-'
                }
            } else if (formatter) { // If taskKey is null, it means the value is derived or calculated (e.g., DaysToComplete)
                const formatted = formatter(null, task); // Call the formatter, passing the task object for context
                if (typeof formatted === 'object' && formatted !== null) { // Handle formatted object response
                    displayValue = formatted.text || '-';
                    displayClass = formatted.class || '';
                } else { // Handle simple string response
                    displayValue = formatted || '-';
                }
            }
            
            // Update the display element (e.g., `modalCategory`)
            if (modalField) {
                modalField.textContent = displayValue; // Set the text content
                // Clear previous dynamic classes (like priority/status styling) before applying new ones
                modalField.className = modalField.className.split(' ').filter(c => !c.startsWith('priority-') && !c.startsWith('status-')).join(' '); 
                if (displayClass) displayClass.split(' ').forEach(c => modalField.classList.add(c)); // Add any new classes from the formatter
            }
            
            // Update the edit element (e.g., `editCategory`)
            if (editField) {
                if (editField.tagName === 'SELECT') { // Special handling for select elements
                    // Find the option that matches the current value or display text and select it
                    const optionToSelect = Array.from(editField.options).find(opt => String(opt.value) === String(editValue) || opt.textContent === displayValue);
                    if (optionToSelect) optionToSelect.selected = true; // Select the found option
                    else editField.value = editValue || ''; // Fallback: set the value directly if no matching option is found
                } else { // For input fields (date, text, textarea)
                    editField.value = editValue || ''; // Set the value directly
                }
            }
            
            // Manage the visibility of the edit button
            if (editBtn) {
                const isEditFieldVisible = editField && !editField.classList.contains('d-none'); // Check if the edit field is currently visible
                // Toggle the visibility of the edit button: hide it if the edit field is visible, show it if the display field is visible
                editBtn.classList.toggle('d-none', isEditFieldVisible);
            }
        }

        /** Enables inline editing for a specific field in the modal. Hides the display element, shows the edit element, and hides the edit button. */
        function enableEdit(field) { // 'field' is the capitalized field name (e.g., 'Category')
            const modalField = document.getElementById(`modal${field}`); // Get the display element (e.g., `modalCategory`)
            const editField = document.getElementById(`edit${field}`); // Get the edit element (e.g., `editCategory`)
            // Find the edit button associated with this field
            const editBtn = document.querySelector(`[onclick*="enableEdit('${field[0].toLowerCase() + field.slice(1)}')"]`);

            if (modalField) modalField.classList.add('d-none'); // Hide the display element
            if (editField) editField.classList.remove('d-none'); // Show the edit element
            if (editBtn) editBtn.classList.add('d-none'); // Hide the edit button while editing is active

            if (editField) editField.focus(); // Automatically focus the edit input field for user convenience
        }
        
        /** Saves any changes made to a task in the modal form. */
        function saveTaskChanges() {
            const task = tasks.find(t => t.id === currentTaskId); // Find the task currently being edited
            if (!task) return; // Exit if the task is not found

            const previousStatus = getTaskValue(task, 'Статус'); // Store the status before changes for comparison logic

            // Update task fields using the helper function for each editable field
            updateTaskField('Category');
            updateTaskField('Description', true); // Pass `true` for textarea fields
            updateTaskField('Responsible');
            updateTaskField('Priority');
            updateTaskField('Status');
            updateTaskField('DueDate');
            
            // Handle special logic when the task status changes to 'Завершена'
            const newStatus = getTaskValue(task, 'Статус');
            if (newStatus === 'Завершена' && previousStatus !== 'Завершена') {
                task.completedDate = getTodayDate(); // Set the completion date to the current date
                // Add an update entry to the task's history if this status change hasn't been logged yet
                const completionUpdateExists = task.updates.some(u => u.comment === 'Статус изменено на: Завершена');
                if (!completionUpdateExists) {
                    // Record current date and time for the update entry
                    const now = new Date();
                    const dateString = now.toISOString().split('T')[0] + ' ' + now.toLocaleTimeString('ru-RU');
                    task.updates.push({ date: dateString, comment: 'Статус изменено на: Завершена' });
                }
            } else if (newStatus !== 'Завершена' && task.completedDate) {
                // If the status is changed FROM 'Завершена' to something else, clear the completion date
                task.completedDate = '';
            }

            // Recalculate and update the 'Days to Complete' display in the modal
            let daysToCompleteStr = '-';
            if (task.createdDate && task.completedDate) { // If task is completed and dates are valid
                const created = new Date(task.createdDate);
                const completed = new Date(task.completedDate);
                 if (!isNaN(created.getTime()) && !isNaN(completed.getTime())) {
                    daysToCompleteStr = `Выполнено за ${Math.floor((completed - created) / (1000 * 60 * 60 * 24))} д.`;
                }
            } else if (task.createdDate && getTaskValue(task, 'dueDate')) { // If task is not completed but has creation and due dates
                const created = new Date(task.createdDate);
                const due = new Date(getTaskValue(task, 'dueDate'));
                if (!isNaN(created.getTime()) && !isNaN(due.getTime())) {
                    const diffDays = Math.floor((due - created) / (1000 * 60 * 60 * 24));
                    daysToCompleteStr = `Срок: ${diffDays} д.`;
                }
            }
            document.getElementById('modalDaysToComplete').textContent = daysToCompleteStr; // Update the display element
            
            // Reset the UI state for all editable fields in the modal
            taskDetailsModal.querySelectorAll('.col-editable').forEach(col => {
                const editBtn = col.querySelector('.edit-btn'); // Get the edit button
                const modalField = col.querySelector('span:not(.edit-btn)'); // Get the display element (span)
                const editField = col.querySelector('select, input, textarea'); // Get the edit element
                
                if (modalField && editField) { // If both display and edit elements exist
                    modalField.classList.remove('d-none'); // Show the display element
                    editField.classList.add('d-none');     // Hide the edit element
                }
                if (editBtn) editBtn.classList.remove('d-none'); // Make the edit button visible again
            });

            // Update the dashboard's table, charts, and KPIs to reflect the changes made to the task
            initializeTable();
            updateCharts();
            updateKPIs();
            saveDashboardData(); // Persist the updated task data to localStorage
            
            alert('Изменения сохранены'); // Notify the user that changes have been saved
        }

        /** Helper function to update a single task field's value in the task object and its modal UI representation. */
        function updateTaskField(fieldName, isTextArea = false) {
            const modalField = document.getElementById(`modal${fieldName}`); // Get the display element
            const editField = document.getElementById(`edit${fieldName}`); // Get the edit element
            // Find the edit button associated with this field
            const editBtn = document.querySelector(`[onclick*="enableEdit('${fieldName[0].toLowerCase() + fieldName.slice(1)}')"]`);
            // Determine the correct key name for the task object (e.g., 'dueDate' for 'DueDate')
            const fieldKey = fieldName === 'DueDate' ? 'dueDate' : fieldName === 'CreatedDate' ? 'createdDate' : fieldName; 
            const taskKeyForUpdate = fieldKey === 'dueDate' ? 'dueDate' : fieldKey; // Ensure correct key usage for task object update

            const rawValue = editField.value; // Get the raw value from the edit input
            let updatedValue = rawValue; // Initialize updated value

            // Normalize the DueDate if it's being edited and has a value
            if (fieldName === 'DueDate' && updatedValue) {
                updatedValue = normalizeDate(updatedValue); // Normalize the date string
                editField.value = updatedValue; // Update the input field itself with the normalized date
            }
            
            task[taskKeyForUpdate.toLowerCase()] = updatedValue; // Update the task object in the global `tasks` array
            
            // Update the display element (e.g., `modalCategory` span) with the new value
            modalField.textContent = updatedValue || '-';
            
            // Re-apply specific CSS classes if they are tied to the field's value (e.g., Priority, Status)
            if (fieldName === 'Priority') { // Update display text and class for Priority
                const priorityVal = task['приоритет'];
                modalField.textContent = priorityVal === '1' ? 'Высокий' : priorityVal === '2' ? 'Средний' : 'Низкий';
                // Clear old priority classes and apply the new one
                modalField.className = modalField.className.split(' ').filter(c => !c.startsWith('priority-')).join(' ');
                modalField.classList.add(`priority-${priorityVal === '1' ? 'high' : priorityVal === '2' ? 'medium' : 'low'}`);
            } else if (fieldName === 'Status') { // Update display text and class for Status
                const statusVal = task['статус'];
                modalField.textContent = statusVal || 'Не указан';
                modalField.className = `status-badge ${getStatusBadgeClass(statusVal)}`; // Re-apply base badge and status-specific classes
            }
            
            // Reset the UI elements for this field: hide the edit control, show the display element, and make the edit button visible again
            modalField.classList.remove('d-none');
            editField.classList.add('d-none');
            if (editBtn) editBtn.classList.remove('d-none');
        }
        
        /** Populates the comments section of the task details modal with the task's update history. */
        function populateComments(task) {
            const commentsContainer = document.getElementById('modalComments'); // Get the comments container element
            commentsContainer.innerHTML = ''; // Clear any existing comments
            
            // If there are no updates for this task, display a "no updates" message
            if (!task.updates || task.updates.length === 0) {
                commentsContainer.innerHTML = '<p class="text-muted">Нет истории обновлений</p>';
                return;
            }
            
            // Sort the updates chronologically (newest first)
            const sortedUpdates = [...task.updates].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Iterate through the sorted updates and create an HTML element for each comment
            sortedUpdates.forEach(update => {
                const commentDiv = document.createElement('div'); // Container for a single comment item
                commentDiv.className = 'comment-item';
                
                const dateSpan = document.createElement('span'); // Span for the date and time of the update
                dateSpan.className = 'comment-date';
                // Format the date and time using Russian locale settings
                dateSpan.textContent = new Date(update.date).toLocaleString('ru-RU', {
                    year: 'numeric', month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit'
                });
                
                const commentText = document.createElement('div'); // Div to hold the comment text
                commentText.textContent = update.comment;
                
                commentDiv.appendChild(dateSpan); // Add the date span to the comment div
                commentDiv.appendChild(commentText); // Add the comment text div to the comment div
                commentsContainer.appendChild(commentDiv); // Append the complete comment item to the container
            });
        }

        /** Adds a new comment to the currently viewed task. */
        function addComment() {
            const commentText = document.getElementById('newComment').value.trim(); // Get the comment text from the input and trim whitespace
            if (!commentText) { // Validate that the comment is not empty
                alert('Пожалуйста, введите текст комментария.');
                return;
            }
            
            const task = tasks.find(t => t.id === currentTaskId); // Find the task that is currently being edited/viewed
            if (!task) return; // Exit if the task is not found
            
            if (!task.updates) task.updates = []; // Initialize the `updates` array if it doesn't exist
            
            // Get the current date and time, formatted for the update record
            const now = new Date();
            const dateString = now.toISOString().split('T')[0] + ' ' + now.toLocaleTimeString('ru-RU');
            
            task.updates.push({ date: dateString, comment: commentText }); // Add the new comment to the task's updates array
            
            document.getElementById('newComment').value = ''; // Clear the comment input field
            populateComments(task); // Refresh the displayed comments in the modal
            saveDashboardData(); // Save the updated task data to localStorage
        }
        
        /** Adds a new task to the dashboard based on the data entered in the "Add Task" modal form. */
        function addNewTask() {
            const category = document.getElementById('newTaskCategory').value.trim(); // Get category input value
            const description = document.getElementById('newTaskDescription').value.trim(); // Get description input value
            const responsible = document.getElementById('newTaskResponsible').value; // Get responsible person value
            const priority = document.getElementById('newTaskPriority').value; // Get priority value
            const status = document.getElementById('newTaskStatus').value; // Get status value
            const dueDateRaw = document.getElementById('newTaskDueDate').value; // Get raw due date input value
            const dueDate = dueDateRaw ? normalizeDate(dueDateRaw) : ''; // Normalize the due date if provided
            const comment = document.getElementById('newTaskComment').value.trim(); // Get initial comment value
            
            // Basic validation: Category and Description are required fields
            if (!category || !description) {
                alert('Пожалуйста, заполните поля "Категория" и "Описание задачи".');
                return;
            }
            
            const now = new Date();
            const dateString = now.toISOString().split('T')[0] + ' ' + now.toLocaleTimeString('ru-RU'); // Get current date and time
            
            const newTask = { // Construct the new task object
                id: generateId(), // Assign a unique ID
                'Категория': category,
                'Описание задачи': description,
                'Ответственный': responsible,
                'Приоритет': priority,
                'Статус': status,
                dueDate: dueDate,
                createdDate: dateString, // Set creation date to current date/time
                updates: [], // Initialize an empty array for updates
                completedDate: '' // Initialize completed date as empty
            };
            
            if (comment) { // If an initial comment was provided, add it to the updates array
                newTask.updates.push({ date: dateString, comment: comment });
            }
            
            tasks.push(newTask); // Add the newly created task to the global `tasks` array
            
            // Clear the form fields and close the "Add Task" modal
            document.getElementById('newTaskCategory').value = '';
            document.getElementById('newTaskDescription').value = '';
            document.getElementById('newTaskComment').value = '';
            document.getElementById('newTaskDueDate').value = '';
            addTaskModal.hide();
            
            initializeDashboard(); // Refresh the dashboard views (table, charts, KPIs)
            saveDashboardData(); // Save the updated tasks list to localStorage
            alert('Новая задача успешно добавлена');
        }

        /** Permanently deletes a task from the dashboard after confirming with the user. */
        function deleteTask(taskId) {
            if (!confirm('Вы уверены, что хотите удалить эту задачу? Это действие необратимо.')) {
                return; // Cancel deletion if user clicks 'Cancel'
            }
            tasks = tasks.filter(task => task.id !== taskId); // Filter out the task to be deleted
            initializeTable(); // Re-render the table to reflect the deletion
            updateCharts();    // Update charts
            updateKPIs();      // Update KPIs
            saveDashboardData(); // Save the modified tasks list
            alert('Задача удалена.');
        }
        
        /** Adds a new chart visualization based on user selections in the "Add Chart" modal. */
        function addNewChart() {
            const chartType = document.getElementById('chartType').value; // Get selected chart type
            const chartTitle = document.getElementById('chartTitle').value.trim(); // Get chart title from input
            const dataField = document.getElementById('chartDataField').value; // Get the field to group data by
            const size = document.getElementById('chartSize').value; // Get the desired column size for the chart
            
            // Basic validation: Require a title for the chart
            if (!chartTitle) {
                alert('Пожалуйста, укажите название графика.');
                return;
            }
            
            const newChartId = `chart-${generateId()}`; // Generate a unique ID for the new chart
            addChart(newChartId, chartTitle, chartType, dataField, size); // Add the chart to the dashboard
            
            // Clear the modal form and hide the modal
            document.getElementById('chartTitle').value = '';
            addChartModal.hide();
        }

        /** Exports the currently selected chart to PNG, JPEG, or PDF format. */
        function exportChart() {
            const format = document.getElementById('exportFormat').value; // Get the desired export format (png, jpeg, pdf)
            const fileName = document.getElementById('exportFileName').value.trim() || 'chart'; // Get the filename, use 'chart' as default
            
            const chartDataToExport = charts.find(c => c.id === currentChartId); // Find the chart object by its ID
            if (!chartDataToExport) { // Exit if the chart data is not found
                console.error('Chart data not found for export.');
                return;
            }
            
            const canvasId = currentChartId; // The chart ID is the same as the canvas ID
            const canvas = document.getElementById(canvasId); // Get the chart's canvas element
            if (!canvas) { // Exit if the canvas element is not found
                console.error(`Canvas element not found for chart ID: ${canvasId}`);
                return;
            }
            
            // Handle PDF export using jsPDF and html2canvas libraries
            if (format === 'pdf') {
                const chartTitle = chartDataToExport.title; // Get the chart title for the PDF
                const { jsPDF } = window.jspdf; // Access the jsPDF constructor
                const pdf = new jsPDF('p', 'pt', 'a4'); // Create a new PDF document: Portrait orientation, Points unit, A4 page size
                
                const chartContainerElement = document.getElementById(`col-${canvasId}`); // Get the parent column element containing the chart
                if (!chartContainerElement) { // Exit if the container element is not found
                    console.error('Chart container element not found for PDF export.');
                    return;
                }

                // Use html2canvas to capture the chart container (including title and actions) as an image
                html2canvas(chartContainerElement, { useCORS: true, scale: 2 }).then(function(canvasForPdf) { // Scale parameter increases resolution
                    const imgData = canvasForPdf.toDataURL('image/png'); // Get the captured image as a PNG data URL
                    const pdfWidth = pdf.internal.pageSize.getWidth() - 40; // PDF page width minus left/right margins
                    const pdfHeight = pdf.internal.pageSize.getHeight() - 40; // PDF page height minus top/bottom margins
                    
                    const canvasWidth = canvasForPdf.width; // Width of the captured image
                    const canvasHeight = canvasForPdf.height; // Height of the captured image

                    // Calculate the aspect ratio to fit the image within the PDF page dimensions
                    const ratio = Math.min(pdfWidth / canvasWidth, pdfHeight / canvasHeight);
                    const imgWidth = canvasWidth * ratio; // Calculate scaled image width
                    const imgHeight = canvasHeight * ratio; // Calculate scaled image height

                    const margin = 20; // Define the top margin for the image in the PDF
                    const xPos = (pdfWidth - imgWidth) / 2 + 20; // Center the image horizontally, adjusting for the margin
                    const yPos = margin; // Position the image from the top

                    pdf.addImage(imgData, 'PNG', xPos, yPos, imgWidth, imgHeight); // Add the image data to the PDF document
                    pdf.save(`${fileName}.pdf`); // Save the PDF file locally with the specified name
                }).catch(function(err) { // Catch any errors that occur during html2canvas execution
                    console.error("html2canvas error during PDF export:", err);
                    alert('Ошибка при создании PDF. Проверьте консоль.');
                });
            } else { // Handle PNG and JPEG exports directly from the canvas
                // Use canvas.toBlob for efficient creation of image data (Blob object)
                canvas.toBlob(function(blob) { // Callback receives the Blob
                    const link = document.createElement('a'); // Create a temporary anchor element
                    link.href = URL.createObjectURL(blob); // Create a URL for the Blob object
                    link.download = `${fileName}.${format}`; // Set the download attribute for filename and format
                    link.click(); // Programmatically click the link to trigger the download
                    URL.revokeObjectURL(link.href); // Clean up the Blob URL object
                }, `image/${format}`); // Specify the MIME type for the blob (e.g., 'image/png' or 'image/jpeg')
            }
            
            exportChartModal.hide(); // Hide the export modal after initiating the export
        }

        // --- Persistence (Saving/Loading data and configuration) ---
        /** Saves the current `tasks` array to localStorage. */
        function saveDashboardData() {
            localStorage.setItem('crmDashboardTasks', JSON.stringify(tasks)); // Store tasks as a JSON string
        }

        /** Saves the current configuration of the `charts` array to localStorage. */
        function saveDashboardConfig() {
            // Create a new array containing only essential chart configuration properties, excluding Chart.js instances
            const chartsToSave = charts.map(chart => ({
                id: chart.id,
                title: chart.title,
                type: chart.type,
                dataField: chart.dataField,
                size: chart.size
            }));
            localStorage.setItem('crmDashboardCharts', JSON.stringify(chartsToSave)); // Store chart configurations as JSON
        }
        
        /** Saves both the tasks data and chart configurations to localStorage. */
        function saveCurrentDashboardState() {
            saveDashboardData();
            saveDashboardConfig();
            alert('Данные и настройки графиков сохранены.'); // Notify the user that the state has been saved
        }

        /** Saves the current HTML document content as a downloadable .html file. */
        function saveHtmlFile() {
            const htmlContent = document.documentElement.outerHTML; // Get the entire HTML document's source code
            const blob = new Blob([htmlContent], { type: 'text/html' }); // Create a Blob object from the HTML content with the correct MIME type
            const url = URL.createObjectURL(blob); // Create a temporary URL for the Blob
            
            const a = document.createElement('a'); // Create a temporary anchor element
            a.href = url;
            a.download = 'CRM_Dashboard_Export.html'; // Set the download filename
            document.body.appendChild(a); // Append the anchor element to the document body
            a.click(); // Simulate a click on the anchor to trigger the download dialog
            document.body.removeChild(a); // Remove the anchor element after it has served its purpose
            URL.revokeObjectURL(url); // Release the temporary URL object to free up memory
        }

        /** Loads tasks and chart configurations from localStorage when the application starts. */
        function loadDashboard() {
            // Load tasks from localStorage
            const savedTasks = localStorage.getItem('crmDashboardTasks');
            if (savedTasks) { // If saved tasks data exists
                try {
                    tasks = JSON.parse(savedTasks); // Parse the JSON string back into the `tasks` array
                } catch (e) {
                    console.error("Error parsing tasks from localStorage:", e);
                    tasks = []; // If parsing fails (e.g., corrupted data), reset `tasks` to an empty array
                }
            }
            
            // Load charts from localStorage
            const savedCharts = localStorage.getItem('crmDashboardCharts');
            if (savedCharts) { // If saved charts configuration exists
                try {
                    const chartsConfig = JSON.parse(savedCharts); // Parse the saved chart configurations
                    // Recreate charts from the loaded configurations. `saveToStorage: false` prevents re-saving immediately.
                    chartsConfig.forEach(c => addChart(c.id, c.title, c.type, c.dataField, c.size, false));
                } catch (e) {
                    console.error("Error parsing charts from localStorage:", e);
                    // If chart configurations fail to parse, default charts will be added later if needed
                }
            }
            
            initializeDashboard(); // Initialize the dashboard UI after loading data
        }

        // --- Initialisation and Event Listeners ---
        /** Initializes the entire dashboard: loads data, renders table, charts, KPIs, and sets up event listeners. */
        function initializeDashboard() {
            initializeTable(); // Render the task table with initial or loaded data
            initializeCharts(); // Load and render charts from configurations
            updateKPIs();       // Update the KPI values based on the loaded data
            updateFilterOptions(); // Populate dynamic filter options (e.g., task categories) from data

            // Initialize all Bootstrap tooltips on the page to make them functional
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.forEach(function (tooltipTriggerEl) {
                new bootstrap.Tooltip(tooltipTriggerEl);
            });
        }

        /** Populates dynamic filter options (e.g., task categories) from the current task data. */
        function updateFilterOptions() {
            // Extract unique categories from tasks, filter out empties, sort them alphabetically
            const categories = [...new Set(tasks.map(task => getTaskValue(task, 'Категория')).filter(Boolean))]
                                .sort();
            const categoryFilter = document.getElementById('categoryFilter'); // The filter's multi-select element
            const categoryListDatalist = document.getElementById('categoryList'); // The datalist for the 'Add Task' modal's category input
            
            categoryFilter.innerHTML = ''; // Clear existing options to avoid duplicates
            categoryListDatalist.innerHTML = '';
            
            categories.forEach(cat => { // For each unique category
                const option = document.createElement('option'); // Create an <option> element
                option.value = cat;
                option.textContent = cat;
                categoryFilter.appendChild(option); // Add to the filter select element
                
                const datalistOption = document.createElement('option'); // Create an <option> for the datalist
                datalistOption.value = cat;
                categoryListDatalist.appendChild(datalistOption); // Add to the datalist for suggestions
            });
        }

        // --- Event Listeners Setup ---
        // Ensure the DOM is fully loaded and parsed before attaching event listeners
        document.addEventListener('DOMContentLoaded', () => {
            loadDashboard(); // Load saved data and configurations on page load

            // Attach event listeners to interactive elements
            document.getElementById('applyFilters').addEventListener('click', applyFilters); // Apply filters when button is clicked
            document.getElementById('resetFilters').addEventListener('click', resetFilters); // Reset filters
            taskSearchInput.addEventListener('input', applyFilters); // Apply filters in real-time as user types in the search bar
            document.getElementById('addTask').addEventListener('click', () => addTaskModal.show()); // Show the "Add Task" modal
            document.getElementById('exportExcel').addEventListener('click', exportToExcel); // Attach the export to Excel function
            document.getElementById('addChartBtn').addEventListener('click', () => addChartModal.show()); // Show the "Add Chart" modal
            document.getElementById('uploadExcelBtn').addEventListener('click', () => document.getElementById('excelFileInput').click()); // Trigger the hidden file input for Excel upload
            document.getElementById('excelFileInput').addEventListener('change', (e) => { // Handle file selection from the input
                if (!e.target.files || e.target.files.length === 0) return; // Exit if no file is selected
                // Process each selected Excel file
                Array.from(e.target.files).forEach(file => parseExcel(file));
                e.target.value = ''; // Clear the file input value to allow re-uploading the same file
            });
            document.getElementById('saveDashboardBtn').addEventListener('click', saveCurrentDashboardState); // Save current dashboard state (tasks + charts)
            document.getElementById('saveHtmlBtn').addEventListener('click', saveHtmlFile); // Save the current dashboard as an HTML file
            filterKpiToggle.addEventListener('change', updateKPIs); // Update KPIs when the filter toggle's state changes

            // Add event listeners to modal input fields to manage the visibility of edit buttons
            taskDetailsModalEl.querySelectorAll('select, input[type="date"], textarea').forEach(field => {
                field.addEventListener('focus', function() { // When an input field within the modal receives focus
                    const capitalizedFieldName = this.id.replace(/^edit|modal/, ''); // Derive the field name (e.g., 'Category' from 'editCategory' or 'modalCategory')
                    // Find the edit button associated with this field using its `onclick` attribute
                    const editBtn = document.querySelector(`[onclick*="enableEdit('${capitalizedFieldName[0].toLowerCase() + capitalizedFieldName.slice(1)}')"]`);
                    if (editBtn) {
                        const modalField = document.getElementById(`modal${capitalizedFieldName}`); // Get the corresponding display element (e.g., `modalCategory` span)
                        // Show the edit button only if the display element is currently visible (i.e., not in edit mode)
                        if (modalField && !modalField.classList.contains('d-none')) {
                           editBtn.classList.remove('d-none'); // Make the edit button visible
                        }
                    }
                });
            });
            
            // When the task details modal is shown, reset its state and ensure edit controls are correctly managed
            taskDetailsModalEl.addEventListener('shown.bs.modal', () => {
                currentTaskId = null; // Reset the current task ID
                // Iterate through all editable fields within the modal
                taskDetailsModalEl.querySelectorAll('.col-editable').forEach(col => {
                    const editBtn = col.querySelector('.edit-btn'); // Get the edit button
                    const modalField = col.querySelector('span:not(.edit-btn)'); // Get the display element (span)
                    // If both edit button and display element exist and display element is visible
                    if (editBtn && modalField && !modalField.classList.contains('d-none')) {
                        editBtn.classList.remove('d-none'); // Ensure the edit button is visible
                    }
                });
            });
            
            // --- Chart Drag and Drop Logic Setup ---
            let draggedItem = null; // Variable to store the element currently being dragged
            
            // Handler for when a drag operation starts on a chart column
            function handleDragStart(e) {
                draggedItem = e.target.closest('.col-md-*'); // Identify the column element being dragged
                if (draggedItem) {
                    e.dataTransfer.effectAllowed = 'move'; // Specify the allowed drag effect
                    e.dataTransfer.setData('text/html', this.innerHTML); // Set data to transfer (optional, can be used by drop target)
                    this.classList.add('drag-over'); // Add a visual indicator to the dragged item
                }
            }

            // Handler for when a dragged item is moved over a valid drop target
            function handleDragOver(e) {
                e.preventDefault(); // Prevent default browser behavior (which would prevent dropping)
                e.dataTransfer.dropEffect = 'move'; // Indicate that a 'move' operation is allowed
                this.classList.add('drag-over'); // Add a visual indicator to the drop target
            }

            // Handler for when a dragged item leaves a drop target
            function handleDragLeave() {
                this.classList.remove('drag-over'); // Remove the visual indicator from the drop target
            }

            // Handler for when a dragged item is dropped onto a target
            function handleDrop(e) {
                e.preventDefault(); // Prevent default browser behavior
                this.classList.remove('drag-over'); // Remove visual indicator from the drop target
                
                const droppedOnItem = e.target.closest('.col-md-*'); // Identify the element the item was dropped upon
                // Ensure the drop is valid: on a chart column, and not the same item being dragged
                if (!droppedOnItem || !draggedItem || droppedOnItem === draggedItem) return;

                const chartsRow = document.getElementById('chartsRow'); // Get the container holding all chart columns
                const allColumns = Array.from(chartsRow.children); // Get all chart columns as an array for index comparison
                const draggedIndex = allColumns.indexOf(draggedItem); // Get the index of the item being dragged
                const droppedOnIndex = allColumns.indexOf(droppedOnItem); // Get the index of the item being dropped onto
                
                // Reorder the DOM elements to reflect the new arrangement
                if (draggedIndex < droppedOnIndex) { // If the dragged item was positioned before the target item
                    chartsRow.insertBefore(draggedItem, droppedOnItem.nextSibling); // Insert the dragged item immediately after the target item
                } else { // If the dragged item was positioned after the target item
                    chartsRow.insertBefore(draggedItem, droppedOnItem); // Insert the dragged item before the target item
                }

                saveDashboardConfig(); // Save the new order of charts to localStorage to persist the arrangement
            }
            
            // --- Additional Functionality Button: Delete All Tasks ---
            // Add an event listener to the "Delete All Tasks" button
            document.getElementById('deleteAllTasksBtn').addEventListener('click', deleteAllTasks);
        });
        
        /** Exports the current task data to an Excel file (.xlsx). */
        function exportToExcel() {
            // Prepare data for export: transform `tasks` array into an array of flat objects suitable for Excel
            const exportData = tasks.map(task => {
                const exportTask = { // Create a new object for each task
                    'Категория': getTaskValue(task, 'Категория'),
                    'Описание задачи': getTaskValue(task, 'Описание задачи'),
                    'Ответственный': getTaskValue(task, 'Ответственный'),
                    'Приоритет': (() => { // Convert numeric priority to its text representation
                        const prio = getTaskValue(task, 'Приоритет');
                        if (prio === '1') return 'Высокий';
                        if (prio === '2') return 'Средний';
                        return 'Низкий';
                    })(),
                    'Статус': getTaskValue(task, 'Статус'),
                    'Дата создания': task.createdDate || '', // Use empty string if date is missing
                    'Плановая дата завершения': getTaskValue(task, 'dueDate') || '',
                    'Дата завершения': task.completedDate || ''
                };
                
                // If task has update history (comments), add them as separate columns in Excel
                if (task.updates && task.updates.length > 0) {
                    // Sort updates chronologically (oldest first) to ensure columns appear in order
                    const sortedUpdates = [...task.updates].sort((a, b) => new Date(a.date) - new Date(b.date));
                    
                    sortedUpdates.forEach(update => {
                        // Format the update date and time to be used as a column header
                        const updateDate = new Date(update.date);
                        // ISO string format like "YYYY-MM-DD HH:MM:SS"
                        const dateHeader = updateDate.toISOString().replace('T', ' ').split('.')[0]; 
                        exportTask[dateHeader] = update.comment; // Use the formatted date as the column header, and the comment as the cell value
                    });
                }
                return exportTask; // Return the processed task object
            });
            
            // Create an Excel worksheet from the array of task objects
            const ws = XLSX.utils.json_to_sheet(exportData);
            
            // Create a new Excel workbook and append the worksheet to it
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "CRM Tasks"); // Name the sheet "CRM Tasks"
            
            // Write the workbook to an Excel file (.xlsx)
            XLSX.writeFile(wb, "CRM_Tasks_Export.xlsx");
        }

        /** Deletes all tasks from the dashboard after user confirmation. */
        function deleteAllTasks() {
            if (!confirm('Вы уверены, что хотите удалить ВСЕ задачи? Это действие необратимо.')) {
                return; // Cancel the operation if the user clicks 'Cancel'
            }
            tasks = []; // Empty the global tasks array
            initializeDashboard(); // Refresh the dashboard views (table, charts, KPIs) to reflect the change
            saveDashboardData(); // Save the now-empty tasks list to localStorage
            alert('Все задачи удалены.');
        }

        /** Opens the task details modal in edit mode for the specified task ID. */
        function editTask(taskId) {
            const task = tasks.find(t => t.id === taskId); // Find the task to edit
            if (!task) return; // Exit if the task is not found
            
            currentTaskId = taskId; // Set the current task ID for modal operations
            
            // Set the modal title indicating it's an edit operation
            document.getElementById('taskModalTitle').textContent = `Редактирование: ${getTaskValue(task, 'Категория') || 'Без категории'}`;
            
            // Populate all modal fields with task data, setting up both display and edit elements
            displayTaskField('Category', task, 'Категория');
            displayTaskField('Description', task, 'Описание задачи', null, true); // Pass 'true' for textarea fields to handle content correctly
            displayTaskField('Responsible', task, 'Ответственный');
            // Priority field formatter for text display and applying color class
            displayTaskField('Priority', task, 'Приоритет', (val) => {
                if (val === '1') return { text: 'Высокий', class: 'priority-high' };
                if (val === '2') return { text: 'Средний', class: 'priority-medium' };
                return { text: 'Низкий', class: 'priority-low' };
            });
            // Status field formatter to display as a styled badge
            displayTaskField('Status', task, 'Статус', (val) => {
                const badge = document.createElement('span'); // Create span for the badge
                badge.classList.add('status-badge', getStatusBadgeClass(val)); // Add base and status-specific classes
                badge.textContent = val || 'Не указан'; // Set badge text
                return badge; // Return the badge element
            });
            displayTaskField('CreatedDate', task, 'createdDate'); // Display creation date
            displayTaskField('DueDate', task, 'dueDate'); // Display due date
            displayTaskField('CompletedDate', task, 'completedDate'); // Display completion date
            // Calculated field for days to complete or days remaining until due date
            displayTaskField('DaysToComplete', task, null, () => getTaskToDaysToComplete(task)); 

            populateComments(task); // Populate the task's history/comments section
            
            document.getElementById('saveChangesBtn').classList.remove('d-none'); // Make the "Save Changes" button visible
            taskDetailsModal.show(); // Show the task details modal

            // After the modal is shown, ensure edit controls are correctly managed
            taskDetailsModal.querySelectorAll('.col-editable').forEach(col => {
                const editBtn = col.querySelector('.edit-btn'); // Get the edit button
                const modalField = col.querySelector('span:not(.edit-btn)'); // Get the display element (span)
                const editField = col.querySelector('select, input, textarea'); // Get the edit element
                
                // If the edit field is hidden BUT the display field is visible, make the edit button visible
                if (editField && editField.classList.contains('d-none') && modalField && !modalField.classList.contains('d-none')) {
                    if (editBtn) editBtn.classList.remove('d-none');
                } else if (editField && !editField.classList.contains('d-none')) { // If the edit field is visible (meaning we are actively editing)
                    // Hide the display element and the edit button
                    if (modalField) modalField.classList.add('d-none');
                    if (editBtn) editBtn.classList.add('d-none');
                }
            });
        }
    </script>

</body></html>